<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-06-12">

<title>Mémoire – Menu principal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Menu principal</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">À propos</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/isabel6198"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/isabel-palacio-9470a291/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text">LinkedIn</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#présentation" id="toc-présentation" class="nav-link active" data-scroll-target="#présentation"><strong>Présentation</strong></a>
  <ul class="collapse">
  <li><a href="#sujet-détude" id="toc-sujet-détude" class="nav-link" data-scroll-target="#sujet-détude">Sujet d’étude</a></li>
  <li><a href="#présentation-des-données" id="toc-présentation-des-données" class="nav-link" data-scroll-target="#présentation-des-données">Présentation des données</a></li>
  <li><a href="#méthodologie" id="toc-méthodologie" class="nav-link" data-scroll-target="#méthodologie">Méthodologie</a></li>
  <li><a href="#conclusion-et-discussion" id="toc-conclusion-et-discussion" class="nav-link" data-scroll-target="#conclusion-et-discussion">Conclusion et discussion</a></li>
  <li><a href="#librairies" id="toc-librairies" class="nav-link" data-scroll-target="#librairies">Librairies</a></li>
  </ul></li>
  <li><a href="#analyse-exploratoire" id="toc-analyse-exploratoire" class="nav-link" data-scroll-target="#analyse-exploratoire">Analyse exploratoire</a>
  <ul class="collapse">
  <li><a href="#chargement-de-données" id="toc-chargement-de-données" class="nav-link" data-scroll-target="#chargement-de-données">Chargement de données</a>
  <ul class="collapse">
  <li><a href="#valeurs-manquantes-et-format-des-données" id="toc-valeurs-manquantes-et-format-des-données" class="nav-link" data-scroll-target="#valeurs-manquantes-et-format-des-données">Valeurs manquantes et format des données</a></li>
  </ul></li>
  <li><a href="#statistiques-descriptives" id="toc-statistiques-descriptives" class="nav-link" data-scroll-target="#statistiques-descriptives">Statistiques descriptives</a>
  <ul class="collapse">
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot">Boxplot</a></li>
  <li><a href="#graphiques-des-séries" id="toc-graphiques-des-séries" class="nav-link" data-scroll-target="#graphiques-des-séries">Graphiques des séries</a></li>
  <li><a href="#convertir-en-time-series" id="toc-convertir-en-time-series" class="nav-link" data-scroll-target="#convertir-en-time-series">Convertir en time series</a></li>
  </ul></li>
  <li><a href="#points-atypiques-ou-outliers" id="toc-points-atypiques-ou-outliers" class="nav-link" data-scroll-target="#points-atypiques-ou-outliers">Points atypiques ou Outliers</a>
  <ul class="collapse">
  <li><a href="#enregistrement-données-ajustés" id="toc-enregistrement-données-ajustés" class="nav-link" data-scroll-target="#enregistrement-données-ajustés">Enregistrement données ajustés</a></li>
  </ul></li>
  <li><a href="#récupération-base-de-données-ajustées" id="toc-récupération-base-de-données-ajustées" class="nav-link" data-scroll-target="#récupération-base-de-données-ajustées">Récupération base de données ajustées</a>
  <ul class="collapse">
  <li><a href="#skewness-kurtosis" id="toc-skewness-kurtosis" class="nav-link" data-scroll-target="#skewness-kurtosis">Skewness, kurtosis</a></li>
  <li><a href="#test-de-normalité" id="toc-test-de-normalité" class="nav-link" data-scroll-target="#test-de-normalité">Test de normalité</a></li>
  <li><a href="#corrélation" id="toc-corrélation" class="nav-link" data-scroll-target="#corrélation">Corrélation</a></li>
  </ul></li>
  <li><a href="#composants" id="toc-composants" class="nav-link" data-scroll-target="#composants">Composants</a></li>
  <li><a href="#test-de-tendance-mann-kendall" id="toc-test-de-tendance-mann-kendall" class="nav-link" data-scroll-target="#test-de-tendance-mann-kendall">Test de tendance Mann-Kendall</a></li>
  <li><a href="#test-saisonnière" id="toc-test-saisonnière" class="nav-link" data-scroll-target="#test-saisonnière">Test Saisonnière</a>
  <ul class="collapse">
  <li><a href="#correlogramme-des-variables-saisonnières" id="toc-correlogramme-des-variables-saisonnières" class="nav-link" data-scroll-target="#correlogramme-des-variables-saisonnières">Correlogramme des variables saisonnières</a></li>
  <li><a href="#périodogramme" id="toc-périodogramme" class="nav-link" data-scroll-target="#périodogramme">Périodogramme</a></li>
  </ul></li>
  <li><a href="#test-adf" id="toc-test-adf" class="nav-link" data-scroll-target="#test-adf">Test ADF</a>
  <ul class="collapse">
  <li><a href="#graphiques-des-variables-non-stationnaires-test-adf" id="toc-graphiques-des-variables-non-stationnaires-test-adf" class="nav-link" data-scroll-target="#graphiques-des-variables-non-stationnaires-test-adf">Graphiques des variables non stationnaires Test ADF</a></li>
  </ul></li>
  <li><a href="#test-kpss" id="toc-test-kpss" class="nav-link" data-scroll-target="#test-kpss">Test KPSS</a></li>
  <li><a href="#correction" id="toc-correction" class="nav-link" data-scroll-target="#correction">Correction</a>
  <ul class="collapse">
  <li><a href="#décomposition" id="toc-décomposition" class="nav-link" data-scroll-target="#décomposition">Décomposition</a></li>
  <li><a href="#désaisonalitation" id="toc-désaisonalitation" class="nav-link" data-scroll-target="#désaisonalitation">Désaisonalitation</a></li>
  <li><a href="#différenciation-des-séries-non-stationnaires-par-la-tendance-stochastique" id="toc-différenciation-des-séries-non-stationnaires-par-la-tendance-stochastique" class="nav-link" data-scroll-target="#différenciation-des-séries-non-stationnaires-par-la-tendance-stochastique">Différenciation des séries non stationnaires par la tendance stochastique</a></li>
  <li><a href="#tests-après-corrections" id="toc-tests-après-corrections" class="nav-link" data-scroll-target="#tests-après-corrections">Tests après corrections</a></li>
  <li><a href="#data-frame-avec-les-variables-stationnaires" id="toc-data-frame-avec-les-variables-stationnaires" class="nav-link" data-scroll-target="#data-frame-avec-les-variables-stationnaires">Data frame avec les variables stationnaires</a></li>
  </ul></li>
  <li><a href="#sélection-des-variables" id="toc-sélection-des-variables" class="nav-link" data-scroll-target="#sélection-des-variables">Sélection des variables</a></li>
  <li><a href="#deuxième-approche-de-sélection" id="toc-deuxième-approche-de-sélection" class="nav-link" data-scroll-target="#deuxième-approche-de-sélection">Deuxième approche de sélection</a></li>
  </ul></li>
  <li><a href="#modeles" id="toc-modeles" class="nav-link" data-scroll-target="#modeles">MODELES</a>
  <ul class="collapse">
  <li><a href="#modèle" id="toc-modèle" class="nav-link" data-scroll-target="#modèle">1. Modèle</a>
  <ul class="collapse">
  <li><a href="#hypothèses" id="toc-hypothèses" class="nav-link" data-scroll-target="#hypothèses">Hypothèses</a></li>
  </ul></li>
  <li><a href="#modèle-2-différencié---logarithmique" id="toc-modèle-2-différencié---logarithmique" class="nav-link" data-scroll-target="#modèle-2-différencié---logarithmique">2. Modèle 2: différencié - logarithmique</a></li>
  <li><a href="#modèle-3-index-temporel" id="toc-modèle-3-index-temporel" class="nav-link" data-scroll-target="#modèle-3-index-temporel">3. Modèle 3 index temporel</a></li>
  <li><a href="#modèle-4-tendance-déterministe-corrigée" id="toc-modèle-4-tendance-déterministe-corrigée" class="nav-link" data-scroll-target="#modèle-4-tendance-déterministe-corrigée">4. Modèle 4 tendance déterministe corrigée</a></li>
  <li><a href="#modèle-5-avec-lag" id="toc-modèle-5-avec-lag" class="nav-link" data-scroll-target="#modèle-5-avec-lag">5. Modèle 5 avec lag</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#armax" id="toc-armax" class="nav-link" data-scroll-target="#armax">ARMAX</a>
  <ul class="collapse">
  <li><a href="#test-modèle-armax-avec-toutes-les-variables-stationnaires" id="toc-test-modèle-armax-avec-toutes-les-variables-stationnaires" class="nav-link" data-scroll-target="#test-modèle-armax-avec-toutes-les-variables-stationnaires">1. Test Modèle ARMAX avec toutes les variables stationnaires</a></li>
  <li><a href="#armax-avec-variables-sélectionnes-par-stepwise-et-best-sub" id="toc-armax-avec-variables-sélectionnes-par-stepwise-et-best-sub" class="nav-link" data-scroll-target="#armax-avec-variables-sélectionnes-par-stepwise-et-best-sub">2. ARMAX Avec variables sélectionnes par stepwise et best sub</a></li>
  <li><a href="#modèle-armax-st2_data-utilise-le-diff_log_ipa" id="toc-modèle-armax-st2_data-utilise-le-diff_log_ipa" class="nav-link" data-scroll-target="#modèle-armax-st2_data-utilise-le-diff_log_ipa">3. Modèle ARMAX (st2_data utilise le diff_log_IPA)</a></li>
  <li><a href="#modèle-armax2---variables-sélectionnés-st2_data-utilise-le-diff_log_ipa" id="toc-modèle-armax2---variables-sélectionnés-st2_data-utilise-le-diff_log_ipa" class="nav-link" data-scroll-target="#modèle-armax2---variables-sélectionnés-st2_data-utilise-le-diff_log_ipa">4. Modèle ARMAX2 - Variables sélectionnés (st2_data utilise le diff_log_IPA)</a></li>
  </ul></li>
  <li><a href="#comparaison-lm-et-armax" id="toc-comparaison-lm-et-armax" class="nav-link" data-scroll-target="#comparaison-lm-et-armax">Comparaison lm et armax</a>
  <ul class="collapse">
  <li><a href="#acf---pacf" id="toc-acf---pacf" class="nav-link" data-scroll-target="#acf---pacf">ACF - PACF</a></li>
  </ul></li>
  <li><a href="#modèle-mix---mcg---ar" id="toc-modèle-mix---mcg---ar" class="nav-link" data-scroll-target="#modèle-mix---mcg---ar">Modèle mix - MCG - AR</a>
  <ul class="collapse">
  <li><a href="#modèle-mco-avec-les-résidus-ajustés-avec-un-modèle-ar1" id="toc-modèle-mco-avec-les-résidus-ajustés-avec-un-modèle-ar1" class="nav-link" data-scroll-target="#modèle-mco-avec-les-résidus-ajustés-avec-un-modèle-ar1">Modèle MCO avec les résidus ajustés avec un modèle AR(1)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mémoire</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Séries temporelles</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">MCO</div>
    <div class="quarto-category">ARMAX</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 12, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>Sensibilité des prix agricoles face aux chocs climatiques</strong></p>
<p><strong>Séries temporelles au Brésil de janvier 2000 à décembre 2022</strong></p>
<section id="présentation" class="level1">
<h1><strong>Présentation</strong></h1>
<p>Cette étude analyse les prix des produits agricoles au Brésil, un acteur clé des enjeux agricoles mondiaux, en utilisant l’indice des prix à la production agricole (IPA) de janvier 2000 à décembre 2022. L’étude a intégré des variables climatiques pour évaluer leur impact, en utilisant des modèles de régression tels que les Moindres Carrés Ordinaires (MCO) et ARMAX. Dans notre approche par les MCO, nous avons rencontré des difficultés telles que l’autocorrélation des résidus et l’hétéroscédasticité. Malgré plusieurs tentatives, le modèle MCO n’a pas pu être validé et nous avons adopté le modèle ARMAX qui s’est avéré plus efficace. Les résultats montrent que le taux de change, le prix du pétrole et l’influence des valeurs passées de l’IPA ont eu un impact statistiquement significatif. Nos recherches révèlent que, bien que les variables climatiques n’aient pas eu un effet notable, la complexité du système agricole suggère qu’une approche globale et uniforme n’est pas adéquate. Ainsi, nous préconisons, tant dans les études que dans l’élaboration des stratégies, l’adoption de mesures localisées qui répondent mieux aux besoins spécifiques des communautés agricoles.</p>
<p><strong>Mots clés&nbsp;<em>:</em></strong> <em>Prix agricoles, Brésil, MCO, ARMAX,&nbsp; R</em></p>
<section id="sujet-détude" class="level3">
<h3 class="anchored" data-anchor-id="sujet-détude">Sujet d’étude</h3>
<p>Le Brésil, l’un des plus grands producteurs agricoles mondiaux, est également riche en biodiversité et ressources environnementales. Toutefois, le pays est marqué par d’importantes disparités économiques et sociales, reflétées dans son secteur agricole qui se divise entre l’agriculture familiale et l’agrobusiness. Depuis 2000, les politiques brésiliennes ont alterné entre progrès et régression. Sous Lula da Silva, des avancées significatives ont été réalisées, tandis que les administrations suivantes ont vu des reculs, notamment avec la suppression de ministères clés et la libéralisation de la politique de réforme agraire. L’administration de Bolsonaro a augmenté les tensions entre développement agricole et conservation environnementale, en particulier avec l’augmentation de la déforestation en Amazonie. En tant que membre des BRICS et du MERCOSUR, le Brésil joue un rôle important dans les discussions internationales. Le traité de libre-échange entre l’UE et le MERCOSUR est un bon exemple de l’importance croissante du pays sur la scène internationale. L’objectif est de comprendre les facteurs qui influencent les prix à la production agricole du pays que beaucoup surnomment «&nbsp;la ferme du monde&nbsp;».</p>
</section>
<section id="présentation-des-données" class="level3">
<h3 class="anchored" data-anchor-id="présentation-des-données">Présentation des données</h3>
<p>Les données s’étendant de janvier 2000 à décembre 2022 avec une fréquence mensuelle, proviennent de trois sources : l’Institut de Recherche Économique Appliquée (IPEA DATA), les Statistiques de l’ONU pour l’alimentation et l’agriculture (FAO STAT), et le Portail de connaissances sur le changement climatique de la Banque mondiale (CCKP). Les variables explicatives incluent les variations de température (°C), les précipitations (mm), le nombre de jours secs consécutifs, le prix du pétrole, le taux de change (BRL/USD), le salaire minimum nominal (SMIC), et les indices des exportations et importations agricoles.</p>
<p>Des statistiques descriptives ont mis en évidence une hausse marquée de l’IPA, particulièrement après 2016.</p>
<p><img src="memoire_y.png" class="img-fluid"></p>
<p>Sur le plan climatique, les données indiquent des périodes de sécheresse plus longues et des fluctuations de température tendant vers des valeurs maximales. En ce qui concerne les variables économiques, le prix du pétrole a subi de fortes fluctuations au cours des deux dernières décennies, principalement en raison du contexte géopolitique mondial. Le taux de change a connu une dévaluation notable depuis 2019, en réponse à la crise du COVID-19, ce qui a contribué à une augmentation exponentielle des exportations, accentuant une tendance déjà forte depuis 2010. Un prétraitement de nos données a été nécessaire en raison de la présence de valeurs atypiques.</p>
</section>
<section id="méthodologie" class="level3">
<h3 class="anchored" data-anchor-id="méthodologie">Méthodologie</h3>
<p>Pour analyser les variations de l’IPA, nous avons utilisé deux méthodes&nbsp;: MCO et ARMAX. Afin d’éviter les régressions fallacieuses et assurer la validité de nos modèles, nous avons vérifié la stationnarité avec les tests ADF et KPSS.</p>
<p>Les séries temporelles présentant une saisonnalité ont été décomposées afin de corriger les variations saisonnières, permettant de mieux isoler les effets des variables explicatives. Nous avons aussi utilisé les tests de Breusch-Godfrey et Breusch-Pagan pour détecter l’autocorrélation et l’hétéroscédasticité, le test de Kolmogorov-Smirnov pour la normalité des résidus, et le test RESET pour la spécification du modèle, confirmant l’adéquation des modèles et la fiabilité des estimations des coefficients.</p>
<p>Nous avons exploré plusieurs modèles en utilisant l’approche MCO. Les problèmes d’hétéroscédasticité et de spécificité ont été corrigés en adoptant une forme semi-logarithmique. Cependant, malgré diverses tentatives, telles que l’introduction d’une variable temporelle, la correction de la tendance déterministe, et l’ajustement des résidus avec un modèle AR(1), les modèles ont continué de présenter une capacité explicative limitée et des problèmes de conformité aux hypothèses. Nous avons alors opté pour des modèles ARMAX, lesquels intègrent les effets des variables exogènes ainsi que la dynamique interne des séries temporelles.</p>
<p><img src="memoire_modeles.png" class="img-fluid"></p>
<p>Le modèle révèle que les valeurs futures de notre série temporelle sont significativement influencées par les valeurs immédiatement antérieures, avec un niveau de significativité de 1%. Par ailleurs, le prix du pétrole est statistiquement significatif au seuil de risque de 5%. Avec un coefficient positif, lorsque les prix du pétrole augmentent, l’indice IPA augmente également. Il en est de même pour le taux de change, cela signifie que lorsque le real brésilien se déprécie,&nbsp; les prix à la production agricole tendent à augmenter.</p>
<p>Concernant les autres variables du modèle, elles ne montrent pas d’impact significatif . Quant à notre variable climatique, la précipitation, elle s’est révélée non significative, indiquant que , dans le cadre de cette étude,&nbsp; les variations des précipitations n’ont pas un impact notable sur l’indice des prix à la production agricole de manière statistiquement mesurable.</p>
</section>
<section id="conclusion-et-discussion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-et-discussion">Conclusion et discussion</h3>
<p>Cette étude nous a montré la complexité du système agricole brésilien et, bien que nos résultats n’aient pas été ceux attendus, cela peut s’expliquer par la manière dont l’agriculture s’adapte aux changements climatiques. Alors que certaines régions voient leur production agricole diminuer en raison de conditions défavorables, d’autres connaissent une augmentation ou délocalisent leur production. Lorsque ces variations régionales sont agrégées au niveau national, les impacts locaux peuvent être masqués, minimisant ainsi les effets perceptibles sur les prix nationaux.</p>
<p>Par ailleurs, les progrès technologiques en agriculture, bien qu’ils puissent améliorer les rendements et la gestion des cultures, introduisent une complexité supplémentaire dans l’évaluation des impacts directs du climat. Les innovations, comme les variétés résistantes à la sécheresse et l’optimisation des intrants, ont renforcé la résilience des cultures face aux aléas climatiques, permettant de maintenir des niveaux de production élevés même dans des conditions difficiles. Cependant, cette intensification pose des défis environnementaux significatifs, tels que l’épuisement des sols et une dépendance accrue aux produits chimiques, qui compliquent l’attribution précise des impacts du changement climatique dans les analyses économiques agricoles.</p>
<p>Il est donc important de mettre en œuvre les avancées technologiques de manière réfléchie pour éviter des conséquences indésirables et de revoir les politiques agricoles pour assurer la durabilité et la sécurité alimentaire dans un climat changeant, en adaptant les pratiques agricoles aux nouvelles réalités climatiques et économiques.</p>
<div style="text-align: center;">
<iframe src="../../../pdf/memoire.pdf" width="80%" height="500px">
</iframe>
</div>
<p>Vous avez la possibilité de télécharger le document ici :) <a href="../../../pdf/memoire.pdf">📥 Télécharger le fichier PDF</a></p>
<p><strong>Présentation du code</strong></p>
<p>Je vous présente ci-dessous, le code utilisé pour mener à bien ce projet, avec les étapes et explications correspondantes.</p>
</section>
<section id="librairies" class="level3">
<h3 class="anchored" data-anchor-id="librairies">Librairies</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PerformanceAnalytics)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(trend)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seastests)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsoutliers)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RJDemetra)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSA)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsoutliers)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BeSS)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="analyse-exploratoire" class="level1">
<h1>Analyse exploratoire</h1>
<section id="chargement-de-données" class="level2">
<h2 class="anchored" data-anchor-id="chargement-de-données">Chargement de données</h2>
<p>Les données de la variable du prix du pétrole ont une fréquence journalière, nous calculons donc la moyenne pour avoir un prix moyen mensuel</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>petrole <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"donnees_br.xlsx"</span>), <span class="at">sheet =</span> <span class="st">'prix_petrole'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>petrole<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(petrole<span class="sc">$</span>date)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  Colonnes pour l'année et le mois</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>petrole <span class="ot">&lt;-</span> petrole <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(date)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>prix_petrole <span class="ot">&lt;-</span> petrole <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">prix_moyen =</span> <span class="fu">mean</span>(prix, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span>  <span class="co"># regroupement après le summarise</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(petrole) <span class="co"># supprime pétrole en jours</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Récupération de l’ensemble de nos variables et remplacement de la variable prix du pétrole en jours, par le prix moyen mensuel</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ensemble de variables</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"donnees_br.xlsx"</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>petrole <span class="ot">&lt;-</span> prix_petrole<span class="sc">$</span>prix_moyen </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="valeurs-manquantes-et-format-des-données" class="level3">
<h3 class="anchored" data-anchor-id="valeurs-manquantes-et-format-des-données">Valeurs manquantes et format des données</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(data)) <span class="co"># vérification des valeurs manquants</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">drop_na</span>(data)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 276  10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data) <span class="co"># vérification format</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [276 × 10] (S3: tbl_df/tbl/data.frame)
 $ date         : chr [1:276] "2000.01" "2000.02" "2000.03" "2000.04" ...
 $ IPA          : num [1:276] 199 196 193 192 193 ...
 $ CDD          : num [1:276] 2.86 2.94 3.03 4.61 12.14 ...
 $ precipitation: num [1:276] 255 241 247 206 124 ...
 $ temperature  : num [1:276] 0.558 0.226 0.159 0.607 0.548 ...
 $ exportations : num [1:276] 7.5 8.4 11.7 20.2 23.2 22.7 22.1 27.4 16.5 16 ...
 $ importations : num [1:276] 81.8 113 117.5 116.5 128.4 ...
 $ SMIC         : num [1:276] 136 136 136 151 151 151 151 151 151 151 ...
 $ taux_change  : num [1:276] 1.8 1.78 1.74 1.77 1.83 ...
 $ petrole      : num [1:276] 25.5 27.8 27.5 22.8 27.7 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On transforme la variable smic en numérique</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>SMIC <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>SMIC)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion la colonne de date en type  yearmon</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.yearmon</span>(data<span class="sc">$</span>date, <span class="st">"%Y.%m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les données climatiques sont complètes jusqu’au mois de décembre 2022, on conserve donc l’ensemble des données du mois de janvier 2000 à décembre 2022. Au total nous avons 276 observations pour 13 variables.</p>
</section>
</section>
<section id="statistiques-descriptives" class="level2">
<h2 class="anchored" data-anchor-id="statistiques-descriptives">Statistiques descriptives</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      date           IPA              CDD         precipitation   
 Min.   :2000   Min.   : 191.6   Min.   : 2.380   Min.   : 33.16  
 1st Qu.:2006   1st Qu.: 401.5   1st Qu.: 4.728   1st Qu.: 72.14  
 Median :2011   Median : 649.3   Median : 8.440   Median :148.39  
 Mean   :2011   Mean   : 748.4   Mean   :10.107   Mean   :147.15  
 3rd Qu.:2017   3rd Qu.: 944.3   3rd Qu.:15.315   3rd Qu.:212.66  
 Max.   :2023   Max.   :2133.2   Max.   :23.340   Max.   :288.10  
  temperature       exportations     importations         SMIC       
 Min.   :-0.0920   Min.   :  7.50   Min.   : 50.80   Min.   : 136.0  
 1st Qu.: 0.7768   1st Qu.: 31.70   1st Qu.: 81.00   1st Qu.: 300.0  
 Median : 1.0695   Median : 48.40   Median : 92.60   Median : 545.0  
 Mean   : 1.0869   Mean   : 59.26   Mean   : 93.65   Mean   : 602.5  
 3rd Qu.: 1.3250   3rd Qu.: 82.65   3rd Qu.:107.47   3rd Qu.: 937.0  
 Max.   : 2.4310   Max.   :194.10   Max.   :149.80   Max.   :1212.0  
  taux_change       petrole      
 Min.   :1.564   Min.   : 18.47  
 1st Qu.:2.002   1st Qu.: 42.53  
 Median :2.473   Median : 62.81  
 Mean   :2.901   Mean   : 65.40  
 3rd Qu.:3.521   3rd Qu.: 85.50  
 Max.   :5.651   Max.   :134.03  </code></pre>
</div>
</div>
<section id="boxplot" class="level3">
<h3 class="anchored" data-anchor-id="boxplot">Boxplot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="at">cols =</span> <span class="fu">where</span>(is.numeric)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">y =</span> value) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="graphiques-des-séries" class="level3">
<h3 class="anchored" data-anchor-id="graphiques-des-séries">Graphiques des séries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">as.yearmon</span>(data<span class="sc">$</span>date))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Boucle sur chaque colonne sauf la date pour créer des graphiques</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (column_name <span class="cf">in</span> <span class="fu">names</span>(data)[<span class="sc">-</span><span class="dv">1</span>]) {</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> .data[[column_name]], <span class="at">colour =</span> .data[[column_name]])) <span class="sc">+</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Série temporelle: "</span>, column_name),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> column_name,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"Intensité"</span>) <span class="sc">+</span>  </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(p)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-7-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="convertir-en-time-series" class="level3">
<h3 class="anchored" data-anchor-id="convertir-en-time-series">Convertir en time series</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boucle pour convertir chaque colonne en ts et les stocker comme variables séparées</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(column_name <span class="cf">in</span> <span class="fu">names</span>(data)[<span class="sc">-</span><span class="dv">1</span>]) {  <span class="co"># Exclure la colonne de date</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Créer une série temporelle pour la colonne actuelle</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    ts_data <span class="ot">&lt;-</span> <span class="fu">ts</span>(data[[column_name]], <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># variable dans l'environnement global avec un nom dynamique</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"ts_"</span>, column_name), ts_data)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="points-atypiques-ou-outliers" class="level2">
<h2 class="anchored" data-anchor-id="points-atypiques-ou-outliers">Points atypiques ou Outliers</h2>
<p>(attention cela peut prendre quelques minutes, possibilité de charger le fichier après correction data.adj (pour données ajustées))</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|message: false</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># on utilise tso() pour chercher les outliers</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>fit_CDD <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_CDD)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>fit_IPA <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_IPA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in locate.outliers.iloop(resid = resid, pars = pars, cval = cval, :
stopped when 'maxit.iloop' was reached</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in locate.outliers.oloop(y = y, fit = fit, types = types, cval = cval,
: stopped when 'maxit.oloop = 4' was reached</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fit_importations <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_importations)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fit_exportations <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_exportations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in locate.outliers.iloop(resid = resid, pars = pars, cval = cval, :
stopped when 'maxit.iloop' was reached</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fit_petrole <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_petrole)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fit_taux_change <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_taux_change)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>fit_SMIC <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_SMIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in locate.outliers.iloop(resid = resid, pars = pars, cval = cval, :
stopped when 'maxit.iloop' was reached
Warning in locate.outliers.iloop(resid = resid, pars = pars, cval = cval, :
stopped when 'maxit.oloop = 4' was reached</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fit_precipitation <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_precipitation)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fit_temperature <span class="ot">&lt;-</span> <span class="fu">tso</span>(ts_temperature)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pour regarder les points atypiques de chaque serie </span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>fit_CDD <span class="co"># sans outliers </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series:  
ARIMA(0,0,2)(2,1,2)[12] 

Coefficients:
         ma1     ma2     sar1     sar2     sma1     sma2
      0.4183  0.2297  -0.8083  -0.0933  -0.0277  -0.6980
s.e.  0.0635  0.0596   0.1733   0.0830   0.1735   0.1586

sigma^2 = 2.206:  log likelihood = -484.75
AIC=983.5   AICc=983.94   BIC=1008.53

No outliers were detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fit_IPA </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_IPA 
Regression with ARIMA(1,1,0) errors 

Coefficients:
         ar1      LS252     TC258     TC263
      0.6912  -149.6890  -77.9185  -42.7527
s.e.  0.0435    13.6418   11.6972   11.6982

sigma^2 = 275.1:  log likelihood = -1160.87
AIC=2331.73   AICc=2331.96   BIC=2349.82

Outliers:
  type ind    time coefhat   tstat
1   LS 252 2020:12 -149.69 -10.973
2   TC 258 2021:06  -77.92  -6.661
3   TC 263 2021:11  -42.75  -3.655</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fit_importations </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_importations 
Regression with ARIMA(1,1,2)(1,0,0)[12] errors 

Coefficients:
         ar1      ma1      ma2    sar1      LS47     AO98    LS195     LS206
      0.0432  -0.7165  -0.1532  0.2900  -29.4529  47.8804  40.0092  -30.3560
s.e.  0.3300   0.3263   0.2703  0.0597    7.4462  12.0018   7.3329    7.3662

sigma^2 = 175.7:  log likelihood = -1097.94
AIC=2213.88   AICc=2214.56   BIC=2246.43

Outliers:
  type ind    time coefhat  tstat
1   LS  47 2003:11  -29.45 -3.955
2   AO  98 2008:02   47.88  3.989
3   LS 195 2016:03   40.01  5.456
4   LS 206 2017:02  -30.36 -4.121</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fit_exportations </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_exportations 
Regression with ARIMA(1,0,0)(0,1,1)[12] errors 

Coefficients:
         ar1     sma1     AO33    AO114    LS185     AO254
      0.7625  -0.6238  25.6306  31.0681  26.0407  -27.9435
s.e.  0.0426   0.0510   6.9851   6.8995   6.8729    7.1521

sigma^2 = 94.47:  log likelihood = -975.31
AIC=1964.61   AICc=1965.05   BIC=1989.65

Outliers:
  type ind    time coefhat  tstat
1   AO  33 2002:09   25.63  3.669
2   AO 114 2009:06   31.07  4.503
3   LS 185 2015:05   26.04  3.789
4   AO 254 2021:02  -27.94 -3.907</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fit_petrole  <span class="co"># sans outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series:  
ARIMA(1,1,0) 

Coefficients:
         ar1
      0.3497
s.e.  0.0567

sigma^2 = 32.51:  log likelihood = -868.48
AIC=1740.95   AICc=1741   BIC=1748.19

No outliers were detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fit_taux_change </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_taux_change 
Regression with ARIMA(0,1,1) errors 

Coefficients:
         ma1    AO34
      0.3165  0.3361
s.e.  0.0573  0.0697

sigma^2 = 0.0143:  log likelihood = 194.75
AIC=-383.5   AICc=-383.41   BIC=-372.65

Outliers:
  type ind    time coefhat tstat
1   AO  34 2002:10  0.3361 4.824</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fit_SMIC </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_SMIC 
Regression with ARIMA(0,0,5)(0,0,2)[12] errors 

Coefficients:
         ma1     ma2     ma3     ma4     ma5     sma1    sma2  intercept
      0.8636  0.6544  0.5548  0.3908  0.1828  -0.9308  0.3063   144.4274
s.e.  0.0632  0.0802  0.0792  0.0747  0.0548   0.0625  0.0594     4.3551
         LS16     LS40     LS65     LS88    AO121     LS122    LS145    LS157
      44.9926  61.3801  71.3287  94.4402  76.0256  120.9066  88.0599  44.6969
s.e.   5.7660   4.2806   3.8698   3.8999   5.0530    4.4605   8.0303  10.7124
        LS169     LS193    AO229     LS230    LS253     LS265
      77.6692  177.1326  95.2608  104.2519  74.4118  107.2180
s.e.   7.9620    4.3219   5.1179    4.4431   8.0232   11.0379

sigma^2 = 69.78:  log likelihood = -972.05
AIC=1990.11   AICc=1994.49   BIC=2073.38

Outliers:
   type ind    time coefhat  tstat
1    LS  16 2001:04   44.99  7.803
2    LS  40 2003:04   61.38 14.339
3    LS  65 2005:05   71.33 18.432
4    LS  88 2007:04   94.44 24.216
5    AO 121 2010:01   76.03 15.046
6    LS 122 2010:02  120.91 27.106
7    LS 145 2012:01   88.06 10.966
8    LS 157 2013:01   44.70  4.172
9    LS 169 2014:01   77.67  9.755
10   LS 193 2016:01  177.13 40.985
11   AO 229 2019:01   95.26 18.613
12   LS 230 2019:02  104.25 23.464
13   LS 253 2021:01   74.41  9.275
14   LS 265 2022:01  107.22  9.714</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fit_precipitation </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ts_precipitation 
Regression with ARIMA(0,0,1)(2,1,0)[12] errors 

Coefficients:
         ma1     sar1     sar2     TC49    AO193
      0.2476  -0.6126  -0.3736  59.2558  86.5774
s.e.  0.0571   0.0580   0.0589  14.5850  18.3329

sigma^2 = 424.8:  log likelihood = -1174.07
AIC=2360.14   AICc=2360.46   BIC=2381.59

Outliers:
  type ind    time coefhat tstat
1   TC  49 2004:01   59.26 4.063
2   AO 193 2016:01   86.58 4.723</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fit_temperature <span class="co"># sans outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series:  
ARIMA(0,1,2) 

Coefficients:
          ma1      ma2
      -0.6600  -0.1641
s.e.   0.0588   0.0651

sigma^2 = 0.1426:  log likelihood = -121.87
AIC=249.74   AICc=249.83   BIC=260.59

No outliers were detected.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_IPA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_SMIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_precipitation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_taux_change)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_exportations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_importations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_CDD )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'x' does not contain outliers to display</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recuperation des séries ajustés </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>adj_IPA <span class="ot">&lt;-</span> fit_IPA<span class="sc">$</span>yadj </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>adj_CDD <span class="ot">&lt;-</span> fit_CDD<span class="sc">$</span>yadj </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>adj_importations <span class="ot">&lt;-</span> fit_importations<span class="sc">$</span>yadj </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>adj_exportations <span class="ot">&lt;-</span> fit_exportations<span class="sc">$</span>yadj </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>adj_petrole <span class="ot">&lt;-</span> fit_petrole<span class="sc">$</span>yadj </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>adj_taux_change <span class="ot">&lt;-</span> fit_taux_change<span class="sc">$</span>yadj </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>adj_SMIC <span class="ot">&lt;-</span> fit_SMIC<span class="sc">$</span>yadj </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>adj_precipitation <span class="ot">&lt;-</span> fit_precipitation<span class="sc">$</span>yadj </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>adj_temperature <span class="ot">&lt;-</span> fit_temperature<span class="sc">$</span>yadj </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="enregistrement-données-ajustés" class="level3">
<h3 class="anchored" data-anchor-id="enregistrement-données-ajustés">Enregistrement données ajustés</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># création d'un dataframe où les séries ajustés seront stockés pour êtres réutilises si nécessaire plus tard </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data_adj <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> data<span class="sc">$</span>date,  </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">IPA =</span> adj_IPA,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CDD =</span> adj_CDD,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">importations =</span> adj_importations,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">exportations =</span> adj_exportations,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">petrole =</span> adj_petrole,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">taux_change =</span> adj_taux_change,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">SMIC =</span> adj_SMIC,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">precipitation =</span> adj_precipitation,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> adj_temperature</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(data_adj, "data_adj.csv", row.names = FALSE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="récupération-base-de-données-ajustées" class="level2">
<h2 class="anchored" data-anchor-id="récupération-base-de-données-ajustées">Récupération base de données ajustées</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data_adj &lt;- read.csv("/Users/Isabel/Desktop/memoire3/data_adj.csv")</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>data_adj<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(data_adj<span class="sc">$</span>Date)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"IPA"</span>, <span class="st">"CDD"</span>, <span class="st">"precipitation"</span>, <span class="st">"temperature"</span>,  <span class="st">"exportations"</span>, <span class="st">"importations"</span>, <span class="st">"taux_change"</span>, <span class="st">"SMIC"</span>, <span class="st">"petrole"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="skewness-kurtosis" class="level3">
<h3 class="anchored" data-anchor-id="skewness-kurtosis">Skewness, kurtosis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>skew_kurt_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> variables,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcul de skewness</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Skewness =</span> <span class="fu">sapply</span>(data_adj[variables], PerformanceAnalytics<span class="sc">::</span>skewness),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcul de kurtosis</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Kurtosis =</span> <span class="fu">sapply</span>(data_adj[variables], PerformanceAnalytics<span class="sc">::</span>kurtosis)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>skew_kurt_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Variable     Skewness    Kurtosis
IPA                     IPA  1.587451131  2.02938496
CDD                     CDD  0.515154009 -1.09215980
precipitation precipitation  0.003335255 -1.39981138
temperature     temperature  0.354093594  0.24637826
exportations   exportations  0.991190627  0.83599348
importations   importations -0.035585053 -0.48953698
taux_change     taux_change  0.982023281 -0.04678673
SMIC                   SMIC  0.038077541 -0.44421037
petrole             petrole  0.340169157 -0.94096896</code></pre>
</div>
</div>
</section>
<section id="test-de-normalité" class="level3">
<h3 class="anchored" data-anchor-id="test-de-normalité">Test de normalité</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#vérification de la normalité des variables </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(data_adj[variables], shapiro.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$IPA

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.81162, p-value &lt; 2.2e-16


$CDD

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.90346, p-value = 2.662e-12


$precipitation

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.92737, p-value = 2.312e-10


$temperature

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.98853, p-value = 0.02765


$exportations

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.93141, p-value = 5.389e-10


$importations

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.99312, p-value = 0.2348


$taux_change

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.87498, p-value = 3.167e-14


$SMIC

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.97073, p-value = 2.005e-05


$petrole

    Shapiro-Wilk normality test

data:  X[[i]]
W = 0.94924, p-value = 3.449e-08</code></pre>
</div>
</div>
</section>
<section id="corrélation" class="level3">
<h3 class="anchored" data-anchor-id="corrélation">Corrélation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|message: false</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  Matrice de corrélation</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_adj[, variables], <span class="at">use =</span> <span class="st">"complete.obs"</span>, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>cor_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      IPA         CDD precipitation temperature exportations
IPA            1.00000000  0.07576372   -0.04386296  0.37647867   0.64924172
CDD            0.07576372  1.00000000   -0.96428022  0.32220175   0.39372744
precipitation -0.04386296 -0.96428022    1.00000000 -0.33938317  -0.35647340
temperature    0.37647867  0.32220175   -0.33938317  1.00000000   0.28936878
exportations   0.64924172  0.39372744   -0.35647340  0.28936878   1.00000000
importations   0.53493377 -0.11595776    0.14735573  0.09049610   0.42171195
taux_change    0.60748523  0.07445183   -0.06679673  0.36570691   0.32702233
SMIC           0.01955579 -0.02748573    0.02980255  0.00564068   0.04615657
petrole        0.42210699  0.08940170   -0.05840727 -0.02391271   0.44837226
              importations taux_change         SMIC     petrole
IPA            0.534933773  0.60748523  0.019555787  0.42210699
CDD           -0.115957758  0.07445183 -0.027485733  0.08940170
precipitation  0.147355729 -0.06679673  0.029802545 -0.05840727
temperature    0.090496098  0.36570691  0.005640680 -0.02391271
exportations   0.421711949  0.32702233  0.046156570  0.44837226
importations   1.000000000  0.06006558 -0.008959876  0.50385277
taux_change    0.060065584  1.00000000  0.098030177 -0.30572061
SMIC          -0.008959876  0.09803018  1.000000000 -0.08122171
petrole        0.503852770 -0.30572061 -0.081221712  1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser la matrice de corrélation</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hc.order =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> ggplot2<span class="sc">::</span>theme_gray,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># spearman correlation test</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#chart.Correlation(data_adj[variables], histogram=TRUE, pch=19,method = c("spearman"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le calcul de la corrélation de Spearman est recommandé lorsque les variables ne suivent pas une loi normalece type de corrélation est dit robuste car il ne dépend pas de la distribution des données. (cours M.Travers)</p>
</section>
</section>
<section id="composants" class="level2">
<h2 class="anchored" data-anchor-id="composants">Composants</h2>
<p>Nous commençons cette partie par deux tests : le premier est le test de tendance monotone de Mann-Kendall,et le deuxième est le test de saisonalité</p>
</section>
<section id="test-de-tendance-mann-kendall" class="level2">
<h2 class="anchored" data-anchor-id="test-de-tendance-mann-kendall">Test de tendance Mann-Kendall</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de tenance pour chaque variable </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(data_adj[variables], <span class="cf">function</span>(x) {</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mk.test</span>(x, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$IPA

    Mann-Kendall trend test

data:  x
z = 22.407, n = 276, p-value &lt; 2.2e-16
alternative hypothesis: true S is greater than 0
sample estimates:
           S         varS          tau 
3.434000e+04 2.348683e+06 9.048748e-01 


$CDD

    Mann-Kendall trend test

data:  x
z = 1.4414, n = 276, p-value = 0.07474
alternative hypothesis: true S is greater than 0
sample estimates:
           S         varS          tau 
2.210000e+03 2.348661e+06 5.825141e-02 


$precipitation

    Mann-Kendall trend test

data:  x
z = -0.87893, n = 276, p-value = 0.8103
alternative hypothesis: true S is greater than 0
sample estimates:
            S          varS           tau 
-1.348000e+03  2.348683e+06 -3.552042e-02 


$temperature

    Mann-Kendall trend test

data:  x
z = 6.3914, n = 276, p-value = 8.22e-11
alternative hypothesis: true S is greater than 0
sample estimates:
           S         varS          tau 
9.796000e+03 2.348657e+06 2.582176e-01 


$exportations

    Mann-Kendall trend test

data:  x
z = 12.289, n = 276, p-value &lt; 2.2e-16
alternative hypothesis: true S is greater than 0
sample estimates:
           S         varS          tau 
1.883500e+04 2.348658e+06 4.964745e-01 


$importations

    Mann-Kendall trend test

data:  x
z = 9.3009, n = 276, p-value &lt; 2.2e-16
alternative hypothesis: true S is greater than 0
sample estimates:
           S         varS          tau 
1.425500e+04 2.348659e+06 3.757397e-01 


$taux_change

    Mann-Kendall trend test

data:  x
z = 10.163, n = 276, p-value &lt; 2.2e-16
alternative hypothesis: true S is greater than 0
sample estimates:
           S         varS          tau 
1.557600e+04 2.348681e+06 4.104456e-01 


$SMIC

    Mann-Kendall trend test

data:  x
z = 0.57934, n = 276, p-value = 0.2812
alternative hypothesis: true S is greater than 0
sample estimates:
           S         varS          tau 
8.880000e+02 2.344153e+06 2.385489e-02 


$petrole

    Mann-Kendall trend test

data:  x
z = 8.2693, n = 276, p-value &lt; 2.2e-16
alternative hypothesis: true S is greater than 0
sample estimates:
           S         varS          tau 
1.267400e+04 2.348683e+06 3.339657e-01 </code></pre>
</div>
</div>
</section>
<section id="test-saisonnière" class="level2">
<h2 class="anchored" data-anchor-id="test-saisonnière">Test Saisonnière</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On transforme en format tsv</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>ts_data <span class="ot">&lt;-</span> <span class="fu">ts</span>(data_adj[, <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">frequency =</span> <span class="dv">12</span>,  <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Verfication de la saisonnalité </span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>test_saison <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"logical"</span>, <span class="fu">ncol</span>(ts_data))  <span class="co"># vecteur pour stocker les résultats</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(test_saison) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ts_data)  <span class="co"># nomme les résultats selon les variables</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ts_data)) {</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  test_saison[i] <span class="ot">&lt;-</span> <span class="fu">isSeasonal</span>(ts_data[, i], <span class="at">test =</span> <span class="st">"wo"</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>test_saison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          IPA           CDD  importations  exportations       petrole 
        FALSE          TRUE          TRUE          TRUE         FALSE 
  taux_change          SMIC precipitation   temperature 
        FALSE         FALSE          TRUE          TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deuxième test Seasonal dummies</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ts_data)) {</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  nom_var <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ts_data)[i]</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">seasdum</span>(ts_data[, i])</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test Seasonal dummies: "</span>, nom_var, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(result)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test Seasonal dummies:  IPA :
Test used:  SeasonalDummies 
 
Test statistic:  1.27 
P-value:  0.2414814

Test Seasonal dummies:  CDD :
Test used:  SeasonalDummies 
 
Test statistic:  283.33 
P-value:  0

Test Seasonal dummies:  importations :
Test used:  SeasonalDummies 
 
Test statistic:  6.31 
P-value:  2.993919e-09

Test Seasonal dummies:  exportations :
Test used:  SeasonalDummies 
 
Test statistic:  23.43 
P-value:  0

Test Seasonal dummies:  petrole :
Test used:  SeasonalDummies 
 
Test statistic:  1.06 
P-value:  0.390488

Test Seasonal dummies:  taux_change :
Test used:  SeasonalDummies 
 
Test statistic:  1.31 
P-value:  0.218587

Test Seasonal dummies:  SMIC :
Test used:  SeasonalDummies 
 
Test statistic:  0.06 
P-value:  0.999995

Test Seasonal dummies:  precipitation :
Test used:  SeasonalDummies 
 
Test statistic:  351.69 
P-value:  0

Test Seasonal dummies:  temperature :
Test used:  SeasonalDummies 
 
Test statistic:  4.35 
P-value:  5.416069e-06</code></pre>
</div>
</div>
<p>Les variables pressentant une saisonnalité d’après les tests sont CDD, importations, Exportations, Précipitation et température</p>
<p>Le code ci-dessous et similaire à celui que nous avons fait precedement pour transformer les variables en time series, on a besoin si nous téléchargeons le fichier data.adj</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boucle pour convertir chaque colonne en ts et les stocker comme variables séparées</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(column_name <span class="cf">in</span> <span class="fu">names</span>(data_adj)[<span class="sc">-</span><span class="dv">1</span>]) {  <span class="co"># Exclure la colonne de date</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Créer une série temporelle pour la colonne actuelle</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    ts_list <span class="ot">&lt;-</span> <span class="fu">ts</span>(data_adj[[column_name]], <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># variable dans l'environnement global avec un nom dynamique</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"ts_"</span>, column_name), ts_list)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="correlogramme-des-variables-saisonnières" class="level3">
<h3 class="anchored" data-anchor-id="correlogramme-des-variables-saisonnières">Correlogramme des variables saisonnières</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ACF pour les variables presentant une saisonalité </span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># CDD</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ts_CDD, <span class="at">main =</span> <span class="st">"ACF CDD sur la série en niveau"</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(ts_CDD,<span class="at">differences =</span> <span class="dv">1</span>), <span class="at">main =</span> <span class="st">"ACF CDD sur la série en différence premiére"</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Précipitation</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ts_precipitation, <span class="at">main =</span> <span class="st">"ACF Precipitations sur la série en niveau"</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(ts_precipitation,<span class="at">differences =</span> <span class="dv">1</span>), <span class="at">main =</span> <span class="st">"ACF Precipitations sur la série en différence premiére"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Témperature</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ts_temperature, <span class="at">main =</span> <span class="st">"ACF Témperature sur la série en niveau "</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(ts_temperature,<span class="at">differences =</span> <span class="dv">1</span>), <span class="at">main =</span> <span class="st">"ACF Témperature sur la série en différence premiére"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Importations</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ts_importations, <span class="at">main =</span> <span class="st">"ACF Importations sur la série en niveau"</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(ts_importations, <span class="at">differences =</span> <span class="dv">1</span>),<span class="at">main =</span> <span class="st">"ACF Importations sur la série en différence premiére"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportations</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ts_exportations, <span class="at">main =</span> <span class="st">"ACF Exportations sur la série en niveau"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(ts_exportations,<span class="at">differences =</span> <span class="dv">1</span>), <span class="at">main =</span> <span class="st">"ACF Exportations sur la série en différence premiére"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="périodogramme" class="level3">
<h3 class="anchored" data-anchor-id="périodogramme">Périodogramme</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Périodogramme ou filtre spectra pour les sérires presentant une saisonalité</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># CDD</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(ts_CDD, <span class="at">main =</span> <span class="st">"Périodogramme CDD sur la série en niveau"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(<span class="fu">diff</span>(ts_CDD,<span class="at">differences =</span> <span class="dv">1</span>), <span class="at">main =</span> <span class="st">"Périodogramme CDD sur la série en différence premiére"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precipitations</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(ts_precipitation, <span class="at">main =</span> <span class="st">"Périodogramme Precipitations sur la série en niveau"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(<span class="fu">diff</span>(ts_precipitation,<span class="at">differences =</span> <span class="dv">1</span>), <span class="at">main =</span> <span class="st">"Périodogramme Precipitations sur la série en différence premiére"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(ts_temperature, <span class="at">main =</span> <span class="st">"Périodogramme Témperature sur la série en niveau "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(<span class="fu">diff</span>(ts_temperature,<span class="at">differences =</span> <span class="dv">1</span>), <span class="at">main =</span> <span class="st">"Périodogramme Témperature sur la série en différence premiére"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importations</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(ts_importations, <span class="at">main =</span> <span class="st">"Périodogramme Importations sur la série en niveau"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(<span class="fu">diff</span>(ts_importations, <span class="at">differences =</span> <span class="dv">1</span>),<span class="at">main =</span> <span class="st">"Périodogramme Importations sur la série en différence premiére"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportations </span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(ts_exportations, <span class="at">main =</span> <span class="st">"Périodogramme Exportations sur la série en niveau"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">periodogram</span>(<span class="fu">diff</span>(ts_exportations,<span class="at">differences =</span> <span class="dv">1</span>), <span class="at">main =</span> <span class="st">"Périodogramme Exportations sur la série en différence premiére"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-19-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots pour les variables climatiques avec les cycles correspondants à chaque série</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_CDD <span class="sc">~</span> <span class="fu">cycle</span>(ts_CDD), <span class="at">main =</span> <span class="st">"Boîte à moustaches des CDD par cycle"</span>, <span class="at">xlab =</span> <span class="st">"Cycle"</span>, <span class="at">ylab =</span> <span class="st">"CDD en jours"</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_precipitation <span class="sc">~</span> <span class="fu">cycle</span>(ts_precipitation), <span class="at">main =</span> <span class="st">"Boîte à moustaches des précipitations par cycle"</span>, <span class="at">xlab =</span> <span class="st">"Cycle"</span>, <span class="at">ylab =</span> <span class="st">"Précipitations en mm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_temperature <span class="sc">~</span> <span class="fu">cycle</span>(ts_temperature), <span class="at">main =</span> <span class="st">"Boîte à moustaches de la température par cycle"</span>, <span class="at">xlab =</span> <span class="st">"Cycle"</span>, <span class="at">ylab =</span> <span class="st">"Variations de température"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables export - importation</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_importations <span class="sc">~</span> <span class="fu">cycle</span>(ts_importations), <span class="at">main =</span> <span class="st">"Boîte à moustaches des importations par cycle"</span>, <span class="at">xlab =</span> <span class="st">"Cycle"</span>, <span class="at">ylab =</span> <span class="st">"Valeurs des importations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ts_exportations <span class="sc">~</span> <span class="fu">cycle</span>(ts_exportations), <span class="at">main =</span> <span class="st">"Boîte à moustaches des exportations par cycle"</span>, <span class="at">xlab =</span> <span class="st">"Cycle"</span>, <span class="at">ylab =</span> <span class="st">"Valeurs des exportations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="test-adf" class="level2">
<h2 class="anchored" data-anchor-id="test-adf">Test ADF</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|message: false</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test ADF </span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(data_adj[variables], <span class="cf">function</span>(x) {</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adf.test</span>(x, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$IPA

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -2.0623, Lag order = 6, p-value = 0.5498
alternative hypothesis: stationary


$CDD

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -15.661, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$precipitation

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -12.168, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$temperature

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -4.9028, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$exportations

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -8.6625, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$importations

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -3.7022, Lag order = 6, p-value = 0.02434
alternative hypothesis: stationary


$taux_change

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -1.4862, Lag order = 6, p-value = 0.7925
alternative hypothesis: stationary


$SMIC

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -6.0839, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$petrole

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -2.178, Lag order = 6, p-value = 0.5011
alternative hypothesis: stationary</code></pre>
</div>
</div>
<section id="graphiques-des-variables-non-stationnaires-test-adf" class="level3">
<h3 class="anchored" data-anchor-id="graphiques-des-variables-non-stationnaires-test-adf">Graphiques des variables non stationnaires Test ADF</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique pour la série IPA</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_adj, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> IPA)) <span class="sc">+</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>,  <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Analyse de la tendance de l'IPA-DI sur la période 01/2000 - 12/2022"</span>) <span class="sc">+</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"IPA Value"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique pour la série petrole</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_adj, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> petrole)) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Analyse de la tendance du prix du pétrole sur la période 01/2000 - 12/2022"</span>) <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Petrole Value"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique pour la série taux de change </span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_adj, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> taux_change)) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Analyse de la tendance du taux de change sur la période 01/2000 - 12/2022"</span>) <span class="sc">+</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Taux de change"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La fonction stat_smooth(method = “loess”) ajoute une courbe de lissage aux données, utilisant la méthode LOESS (Locally Estimated Scatterplot Smoothing). Cette courbe est utile pour visualiser une tendance centrale plus lisse dans les données, ce qui peut être particulièrement bénéfique dans les cas où les données sont bruyantes ou volatiles</p>
</section>
</section>
<section id="test-kpss" class="level2">
<h2 class="anchored" data-anchor-id="test-kpss">Test KPSS</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|message: false</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Trend </span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ts_data)) {</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  nom_var <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ts_data)[i]</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(ts_data[, i], <span class="at">null =</span> <span class="st">"Trend"</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test KPSS: "</span>, nom_var, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(result)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Trend"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  IPA :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.59792, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Trend"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  CDD :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.0099421, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Trend"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  importations :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.37607, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Trend"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  exportations :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.034185, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Trend"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  petrole :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.63433, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Trend"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  taux_change :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.94899, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Trend"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  SMIC :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.018996, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Trend"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  precipitation :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.010157, Truncation lag parameter = 5, p-value = 0.1


Test KPSS:  temperature :

    KPSS Test for Trend Stationarity

data:  ts_data[, i]
KPSS Trend = 0.13529, Truncation lag parameter = 5, p-value = 0.06984</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Level </span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(ts_data)) {</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  nom_var <span class="ot">&lt;-</span> <span class="fu">colnames</span>(ts_data)[i]</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(ts_data[, i], <span class="at">null =</span> <span class="st">"Level"</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Test KPSS: "</span>, nom_var, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(result)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  IPA :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 3.5331, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  CDD :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 0.089483, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  importations :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 2.666, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  exportations :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 3.1023, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  petrole :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 1.2759, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  taux_change :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 2.6251, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  SMIC :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 0.020247, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  precipitation :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 0.030274, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_data[, i], null = "Level"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test KPSS:  temperature :

    KPSS Test for Level Stationarity

data:  ts_data[, i]
KPSS Level = 1.7517, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
</div>
</section>
<section id="correction" class="level2">
<h2 class="anchored" data-anchor-id="correction">Correction</h2>
<p>Nous allons maintenant déterminer le type de schéma des séries, multiplicatif ou addif</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Approche Graphique </span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ts_CDD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ts_precipitation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ts_temperature)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ts_importations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ts_exportations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-24-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Test log-level</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>regx13_CDD <span class="ot">&lt;-</span> <span class="fu">regarima_x13</span>(ts_CDD, <span class="at">spec =</span><span class="st">"RG5c"</span>) </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">s_transform</span>(regx13_CDD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> tfunction adjust aicdiff
      Auto   None      -2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>regx13_precipitation <span class="ot">&lt;-</span> <span class="fu">regarima_x13</span>(ts_precipitation, <span class="at">spec =</span><span class="st">"RG5c"</span>) </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s_transform</span>(regx13_precipitation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> tfunction adjust aicdiff
      Auto   None      -2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>regx13_temperature <span class="ot">&lt;-</span> <span class="fu">regarima_x13</span>(ts_temperature, <span class="at">spec =</span><span class="st">"RG5c"</span>) </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s_transform</span>(regx13_temperature)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> tfunction adjust aicdiff
      Auto   None      -2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>regx13_importations <span class="ot">&lt;-</span> <span class="fu">regarima_x13</span>(ts_importations, <span class="at">spec =</span><span class="st">"RG5c"</span>) </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s_transform</span>(regx13_importations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> tfunction adjust aicdiff
      Auto   None      -2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>regx13_exportations <span class="ot">&lt;-</span> <span class="fu">regarima_x13</span>(ts_exportations, <span class="at">spec =</span><span class="st">"RG5c"</span>) </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">s_transform</span>(regx13_exportations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> tfunction adjust aicdiff
      Auto   None      -2</code></pre>
</div>
</div>
<p>Ce test est spécifiquement conçu pour décider si une transformation logarithmique des données est appropriée</p>
<section id="décomposition" class="level3">
<h3 class="anchored" data-anchor-id="décomposition">Décomposition</h3>
<p>Utilisation de decompose pour une décomposition additive</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Décomposition </span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>decom_CDD <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_CDD, <span class="at">type=</span><span class="st">"additive"</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>decom_precipitations<span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_precipitation, <span class="at">type=</span><span class="st">"additive"</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>decom_temperature <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_temperature, <span class="at">type=</span><span class="st">"additive"</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>decom_importations <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_importations, <span class="at">type=</span><span class="st">"additive"</span>)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>decom_importations <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_importations, <span class="at">type=</span><span class="st">"additive"</span>)</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>decom_exportations <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_exportations, <span class="at">type =</span> <span class="st">"additive"</span>)</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decom_CDD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decom_temperature)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decom_precipitations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decom_importations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-25-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(decom_exportations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-25-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Chacune de nos variables saisonnières est décomposé en ‘trend’, ‘seasonl’, ‘random’</p>
</section>
<section id="désaisonalitation" class="level3">
<h3 class="anchored" data-anchor-id="désaisonalitation">Désaisonalitation</h3>
<p>CDD</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>CDD_deseason <span class="ot">&lt;-</span> ts_CDD <span class="sc">-</span> decom_CDD<span class="sc">$</span>seasonal</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>cdd <span class="ot">&lt;-</span> <span class="fu">ts.intersect</span>(ts_CDD, CDD_deseason)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique </span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(cdd, </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.type =</span> <span class="st">"single"</span>,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"CDD série originale (rouge) et désaisonnalisée (bleu)"</span>,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Période"</span>,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span> <span class="st">"Nombre de jours"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Température</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>temperature_deseason <span class="ot">&lt;-</span> ts_temperature <span class="sc">-</span> decom_temperature<span class="sc">$</span>seasonal</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">ts.intersect</span>(ts_temperature, temperature_deseason)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique </span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(temperature, </span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.type =</span> <span class="st">"single"</span>,</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Témperature série originale (rouge) et désaisonnalisée (bleu)"</span>,</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Période"</span>,</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span> <span class="st">"Variation de la témperature"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Précipitations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>precipitations_deseason <span class="ot">&lt;-</span> ts_precipitation <span class="sc">-</span> decom_precipitations<span class="sc">$</span>seasonal</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>precipitations <span class="ot">&lt;-</span> <span class="fu">ts.intersect</span>(ts_precipitation, precipitations_deseason)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique </span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(precipitations, </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.type =</span> <span class="st">"single"</span>,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Précipitations série originale (rouge) et désaisonnalisée (bleu)"</span>,</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Période"</span>,</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span> <span class="st">"Précipations en mm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Exportation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>exportations_deseason <span class="ot">&lt;-</span> ts_exportations <span class="sc">-</span> decom_exportations<span class="sc">$</span>seasonal</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>exportations <span class="ot">&lt;-</span> <span class="fu">ts.intersect</span>(ts_exportations, exportations_deseason)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique </span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(exportations, </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.type =</span> <span class="st">"single"</span>,</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Exportations série originale (rouge) et désaisonnalisée (bleu)"</span>,</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Période"</span>,</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span> <span class="st">"Indice exportation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Importation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>importations_deseason <span class="ot">&lt;-</span> ts_importations <span class="sc">-</span> decom_importations<span class="sc">$</span>seasonal</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>importations <span class="ot">&lt;-</span> <span class="fu">ts.intersect</span>(ts_importations, importations_deseason)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique </span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(importations, </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.type =</span> <span class="st">"single"</span>,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Importations série originale (rouge) et désaisonnalisée (bleu)"</span>,</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Période"</span>,</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span> <span class="st">"Indice importations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CDD </span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(CDD_deseason, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(CDD_deseason, alternative = "stationary"): p-value smaller
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  CDD_deseason
Dickey-Fuller = -6.1831, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(CDD_deseason,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(CDD_deseason, null = "Trend"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  CDD_deseason
KPSS Trend = 0.053447, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(CDD_deseason,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(CDD_deseason, null = "Level"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  CDD_deseason
KPSS Level = 0.85893, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature </span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(temperature_deseason, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  temperature_deseason
Dickey-Fuller = -3.9825, Lag order = 6, p-value = 0.01032
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(temperature_deseason,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  temperature_deseason
KPSS Trend = 0.14896, Truncation lag parameter = 5, p-value = 0.04753</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(temperature_deseason,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(temperature_deseason, null = "Level"): p-value smaller
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  temperature_deseason
KPSS Level = 1.7965, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># precipitation</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(precipitations_deseason, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(precipitations_deseason, alternative = "stationary"):
p-value smaller than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  precipitations_deseason
Dickey-Fuller = -5.8362, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(precipitations_deseason,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(precipitations_deseason, null = "Trend"): p-value greater
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  precipitations_deseason
KPSS Trend = 0.078174, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(precipitations_deseason,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(precipitations_deseason, null = "Level"): p-value greater
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  precipitations_deseason
KPSS Level = 0.22839, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importations</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(importations_deseason, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  importations_deseason
Dickey-Fuller = -3.3037, Lag order = 6, p-value = 0.07096
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(importations_deseason,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(importations_deseason, null = "Trend"): p-value smaller
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  importations_deseason
KPSS Trend = 0.39913, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(importations_deseason,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(importations_deseason, null = "Level"): p-value smaller
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  importations_deseason
KPSS Level = 2.7696, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Differenciaiton</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>importation_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(importations_deseason, <span class="at">differences =</span> <span class="dv">1</span>)</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(importation_diff, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(importation_diff, alternative = "stationary"): p-value
smaller than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  importation_diff
Dickey-Fuller = -10.305, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(importation_diff,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(importation_diff, null = "Trend"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  importation_diff
KPSS Trend = 0.014578, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(importation_diff,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(importation_diff, null = "Level"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  importation_diff
KPSS Level = 0.031579, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportations </span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(exportations_deseason, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(exportations_deseason, alternative = "stationary"): p-value
smaller than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  exportations_deseason
Dickey-Fuller = -6.2104, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(exportations_deseason,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(exportations_deseason, null = "Trend"): p-value greater
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  exportations_deseason
KPSS Trend = 0.067186, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(exportations_deseason,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(exportations_deseason, null = "Level"): p-value smaller
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  exportations_deseason
KPSS Level = 3.7622, Truncation lag parameter = 5, p-value = 0.01</code></pre>
</div>
</div>
</section>
<section id="différenciation-des-séries-non-stationnaires-par-la-tendance-stochastique" class="level3">
<h3 class="anchored" data-anchor-id="différenciation-des-séries-non-stationnaires-par-la-tendance-stochastique">Différenciation des séries non stationnaires par la tendance stochastique</h3>
</section>
<section id="tests-après-corrections" class="level3">
<h3 class="anchored" data-anchor-id="tests-après-corrections">Tests après corrections</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|message: false</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Differenciation </span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>ipa_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(ts_data[, <span class="st">"IPA"</span>])</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>taux_change_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(ts_data[, <span class="st">"taux_change"</span>])</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>petrole_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(ts_data[, <span class="st">"petrole"</span>])</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="co"># TESTS FINAL ADF ET KPSS </span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a><span class="co">#IPA</span></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(ipa_diff, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  ipa_diff
Dickey-Fuller = -3.9389, Lag order = 6, p-value = 0.01251
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(ipa_diff,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  ipa_diff
KPSS Trend = 0.12657, Truncation lag parameter = 5, p-value = 0.08599</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(ipa_diff,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  ipa_diff
KPSS Level = 0.58846, Truncation lag parameter = 5, p-value = 0.02369</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taux de change</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(taux_change_diff, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(taux_change_diff, alternative = "stationary"): p-value
smaller than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  taux_change_diff
Dickey-Fuller = -6.4556, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(taux_change_diff,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(taux_change_diff, null = "Trend"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  taux_change_diff
KPSS Trend = 0.070678, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(taux_change_diff,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(taux_change_diff, null = "Level"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  taux_change_diff
KPSS Level = 0.17753, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pétrole</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(petrole_diff, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(petrole_diff, alternative = "stationary"): p-value smaller
than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  petrole_diff
Dickey-Fuller = -6.3498, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(petrole_diff,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(petrole_diff, null = "Trend"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  petrole_diff
KPSS Trend = 0.038075, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(petrole_diff,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(petrole_diff, null = "Level"): p-value greater than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  petrole_diff
KPSS Level = 0.055257, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># smic</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(ts_SMIC, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(ts_SMIC, alternative = "stationary"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  ts_SMIC
Dickey-Fuller = -6.0839, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(ts_SMIC,  <span class="at">null =</span> <span class="st">"Trend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_SMIC, null = "Trend"): p-value greater than printed
p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Trend Stationarity

data:  ts_SMIC
KPSS Trend = 0.018996, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(ts_SMIC,  <span class="at">null =</span> <span class="st">"Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(ts_SMIC, null = "Level"): p-value greater than printed
p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    KPSS Test for Level Stationarity

data:  ts_SMIC
KPSS Level = 0.020247, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
</div>
</section>
<section id="data-frame-avec-les-variables-stationnaires" class="level3">
<h3 class="anchored" data-anchor-id="data-frame-avec-les-variables-stationnaires">Data frame avec les variables stationnaires</h3>
<p>Maintenant que nos séries ont été rendues stationnaires, nous allons créer un nouveau dataframe avec ces variables. Cependant, du fait que la différenciation entraîne la perte de la première observation, nous devrons également supprimer la première observation des séries qui étaient déjà stationnaires. Ainsi, nous ajusterons toutes les séries pour aligner leurs longueurs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|message: false</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppression de la première observation des séries non différenciées</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  dataframe avec des longueurs alignées</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>stationnaire_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> data_adj<span class="sc">$</span>Date[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">IPA =</span> ipa_diff,  </span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CDD =</span> CDD_deseason[<span class="sc">-</span><span class="dv">1</span>],  </span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">importations =</span> importation_diff,</span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">exportations =</span> exportations_deseason[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">petrole =</span> petrole_diff, </span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">taux_change =</span> taux_change_diff,  </span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">SMIC =</span> ts_SMIC[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">precipitation =</span> precipitations_deseason[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> temperature_deseason[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb240-17"><a href="#cb240-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|warning: false</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="co">#|message: false</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Re vérification du test ADF </span></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(stationnaire_data[variables], <span class="cf">function</span>(x) {</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adf.test</span>(x, <span class="at">alternative =</span> <span class="st">"stationary"</span>)</span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value
Warning in adf.test(x, alternative = "stationary"): p-value smaller than
printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$IPA

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -3.9389, Lag order = 6, p-value = 0.01251
alternative hypothesis: stationary


$CDD

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -6.4265, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$precipitation

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -5.8847, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$temperature

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -3.9132, Lag order = 6, p-value = 0.01379
alternative hypothesis: stationary


$exportations

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -6.2011, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$importations

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -10.305, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$taux_change

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -6.4556, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$SMIC

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -6.0722, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary


$petrole

    Augmented Dickey-Fuller Test

data:  x
Dickey-Fuller = -6.3498, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test kpss </span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(stationnaire_data[variables], <span class="cf">function</span>(x) {</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kpss.test</span>(x, <span class="at">null =</span> <span class="st">"Trend"</span>)</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(x, null = "Trend"): p-value greater than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(x, null = "Trend"): p-value greater than printed p-value
Warning in kpss.test(x, null = "Trend"): p-value greater than printed p-value
Warning in kpss.test(x, null = "Trend"): p-value greater than printed p-value
Warning in kpss.test(x, null = "Trend"): p-value greater than printed p-value
Warning in kpss.test(x, null = "Trend"): p-value greater than printed p-value
Warning in kpss.test(x, null = "Trend"): p-value greater than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$IPA

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.12657, Truncation lag parameter = 5, p-value = 0.08599


$CDD

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.052585, Truncation lag parameter = 5, p-value = 0.1


$precipitation

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.081222, Truncation lag parameter = 5, p-value = 0.1


$temperature

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.14976, Truncation lag parameter = 5, p-value = 0.04686


$exportations

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.066037, Truncation lag parameter = 5, p-value = 0.1


$importations

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.014578, Truncation lag parameter = 5, p-value = 0.1


$taux_change

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.070678, Truncation lag parameter = 5, p-value = 0.1


$SMIC

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.019059, Truncation lag parameter = 5, p-value = 0.1


$petrole

    KPSS Test for Trend Stationarity

data:  x
KPSS Trend = 0.038075, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test kpss </span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(stationnaire_data[variables], <span class="cf">function</span>(x) {</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kpss.test</span>(x, <span class="at">null =</span> <span class="st">"Level"</span>)</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(x, null = "Level"): p-value smaller than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(x, null = "Level"): p-value greater than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(x, null = "Level"): p-value smaller than printed p-value
Warning in kpss.test(x, null = "Level"): p-value smaller than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kpss.test(x, null = "Level"): p-value greater than printed p-value
Warning in kpss.test(x, null = "Level"): p-value greater than printed p-value
Warning in kpss.test(x, null = "Level"): p-value greater than printed p-value
Warning in kpss.test(x, null = "Level"): p-value greater than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$IPA

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 0.58846, Truncation lag parameter = 5, p-value = 0.02369


$CDD

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 0.83849, Truncation lag parameter = 5, p-value = 0.01


$precipitation

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 0.21186, Truncation lag parameter = 5, p-value = 0.1


$temperature

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 1.7803, Truncation lag parameter = 5, p-value = 0.01


$exportations

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 3.7628, Truncation lag parameter = 5, p-value = 0.01


$importations

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 0.031579, Truncation lag parameter = 5, p-value = 0.1


$taux_change

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 0.17753, Truncation lag parameter = 5, p-value = 0.1


$SMIC

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 0.019994, Truncation lag parameter = 5, p-value = 0.1


$petrole

    KPSS Test for Level Stationarity

data:  x
KPSS Level = 0.055257, Truncation lag parameter = 5, p-value = 0.1</code></pre>
</div>
</div>
</section>
</section>
<section id="sélection-des-variables" class="level2">
<h2 class="anchored" data-anchor-id="sélection-des-variables">Sélection des variables</h2>
<p>1er méthode</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>leaps <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(IPA <span class="sc">~</span> CDD <span class="sc">+</span>  importations <span class="sc">+</span> exportations <span class="sc">+</span>  petrole <span class="sc">+</span>  taux_change <span class="sc">+</span> SMIC <span class="sc">+</span> precipitation <span class="sc">+</span> temperature, <span class="at">data=</span>stationnaire_data, <span class="at">nbest=</span><span class="dv">1</span>, <span class="at">method=</span><span class="fu">c</span>(<span class="st">"exhaustive"</span>))</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(leaps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(IPA ~ CDD + importations + exportations + 
    petrole + taux_change + SMIC + precipitation + temperature, 
    data = stationnaire_data, nbest = 1, method = c("exhaustive"))
8 Variables  (and intercept)
              Forced in Forced out
CDD               FALSE      FALSE
importations      FALSE      FALSE
exportations      FALSE      FALSE
petrole           FALSE      FALSE
taux_change       FALSE      FALSE
SMIC              FALSE      FALSE
precipitation     FALSE      FALSE
temperature       FALSE      FALSE
1 subsets of each size up to 8
Selection Algorithm: exhaustive
         CDD importations exportations petrole taux_change SMIC precipitation
1  ( 1 ) " " " "          "*"          " "     " "         " "  " "          
2  ( 1 ) "*" " "          "*"          " "     " "         " "  " "          
3  ( 1 ) " " " "          "*"          "*"     " "         " "  "*"          
4  ( 1 ) " " " "          "*"          "*"     "*"         " "  "*"          
5  ( 1 ) "*" " "          "*"          "*"     "*"         " "  "*"          
6  ( 1 ) "*" "*"          "*"          "*"     "*"         " "  "*"          
7  ( 1 ) "*" "*"          "*"          "*"     "*"         " "  "*"          
8  ( 1 ) "*" "*"          "*"          "*"     "*"         "*"  "*"          
         temperature
1  ( 1 ) " "        
2  ( 1 ) " "        
3  ( 1 ) " "        
4  ( 1 ) " "        
5  ( 1 ) " "        
6  ( 1 ) " "        
7  ( 1 ) "*"        
8  ( 1 ) "*"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé des critères pour choisir le modèle optimal</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>res.sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(leaps)</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>optimal_model <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adj.R2 =</span> <span class="fu">which.max</span>(res.sum<span class="sc">$</span>adjr2),</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CP =</span> <span class="fu">which.min</span>(res.sum<span class="sc">$</span>cp),</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC =</span> <span class="fu">which.min</span>(res.sum<span class="sc">$</span>bic)</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(optimal_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Adj.R2 CP BIC
1      5  5   3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(res.sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Subset selection object
Call: regsubsets.formula(IPA ~ CDD + importations + exportations + 
    petrole + taux_change + SMIC + precipitation + temperature, 
    data = stationnaire_data, nbest = 1, method = c("exhaustive"))
8 Variables  (and intercept)
              Forced in Forced out
CDD               FALSE      FALSE
importations      FALSE      FALSE
exportations      FALSE      FALSE
petrole           FALSE      FALSE
taux_change       FALSE      FALSE
SMIC              FALSE      FALSE
precipitation     FALSE      FALSE
temperature       FALSE      FALSE
1 subsets of each size up to 8
Selection Algorithm: exhaustive
         CDD importations exportations petrole taux_change SMIC precipitation
1  ( 1 ) " " " "          "*"          " "     " "         " "  " "          
2  ( 1 ) "*" " "          "*"          " "     " "         " "  " "          
3  ( 1 ) " " " "          "*"          "*"     " "         " "  "*"          
4  ( 1 ) " " " "          "*"          "*"     "*"         " "  "*"          
5  ( 1 ) "*" " "          "*"          "*"     "*"         " "  "*"          
6  ( 1 ) "*" "*"          "*"          "*"     "*"         " "  "*"          
7  ( 1 ) "*" "*"          "*"          "*"     "*"         " "  "*"          
8  ( 1 ) "*" "*"          "*"          "*"     "*"         "*"  "*"          
         temperature
1  ( 1 ) " "        
2  ( 1 ) " "        
3  ( 1 ) " "        
4  ( 1 ) " "        
5  ( 1 ) " "        
6  ( 1 ) " "        
7  ( 1 ) "*"        
8  ( 1 ) "*"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot a table of models showing variables in each model.</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="co"># models are ordered by the selection statistic</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Other options for plot( ) are bic, Cp, and adjr2</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(leaps, <span class="at">scale=</span><span class="st">"adjr2"</span>, <span class="at">main =</span> <span class="st">"Adjusted R^2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(leaps, <span class="at">scale=</span><span class="st">"Cp"</span>, <span class="at">main =</span> <span class="st">"Mallow's Cp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(leaps, <span class="at">scale=</span><span class="st">"bic"</span>, <span class="at">main =</span> <span class="st">"BIC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-39-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="deuxième-approche-de-sélection" class="level2">
<h2 class="anchored" data-anchor-id="deuxième-approche-de-sélection">Deuxième approche de sélection</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modele avec toutes les variables, ne sera pas utilisé dans notre analyse - voir méthode STEP</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>modele1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA <span class="sc">~</span>  CDD <span class="sc">+</span>  importations <span class="sc">+</span> exportations <span class="sc">+</span>  petrole <span class="sc">+</span>  taux_change <span class="sc">+</span> SMIC <span class="sc">+</span> precipitation <span class="sc">+</span> temperature, <span class="at">data=</span>stationnaire_data)</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ CDD + importations + exportations + petrole + 
    taux_change + SMIC + precipitation + temperature, data = stationnaire_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-63.082  -9.647  -1.660   7.512 114.297 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    3.50014   21.25705   0.165 0.869338    
CDD            1.67054    0.95321   1.753 0.080834 .  
importations   0.04751    0.08371   0.568 0.570832    
exportations   0.23078    0.05235   4.409 1.51e-05 ***
petrole        0.75790    0.21168   3.580 0.000408 ***
taux_change   21.03398   10.31384   2.039 0.042399 *  
SMIC           0.00493    0.05341   0.092 0.926529    
precipitation -0.16864    0.08630  -1.954 0.051731 .  
temperature   -1.30279    3.41350  -0.382 0.703021    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 20.1 on 266 degrees of freedom
Multiple R-squared:  0.1708,    Adjusted R-squared:  0.1458 
F-statistic: 6.847 on 8 and 266 DF,  p-value: 3.489e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step : Sélection des variables explicatives significatives (modèle linéaire = modele1 )</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>modele0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>stationnaire_data)</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ 1, data = stationnaire_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-60.985 -10.203  -3.965   5.489 132.912 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    7.146      1.311   5.449 1.13e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.75 on 274 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode ascendante</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>step1 <span class="ot">&lt;-</span> <span class="fu">step</span>(modele0, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>modele0, <span class="at">upper=</span>modele1), <span class="at">data=</span>stationnaire_data, <span class="at">direction=</span><span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1694.75
IPA ~ 1

                Df Sum of Sq    RSS    AIC
+ exportations   1   10514.2 119087 1673.5
+ CDD            1    7482.6 122118 1680.4
+ precipitation  1    5178.7 124422 1685.5
+ petrole        1    3258.2 126343 1689.8
+ temperature    1    2522.9 127078 1691.3
&lt;none&gt;                       129601 1694.8
+ taux_change    1     396.9 129204 1695.9
+ importations   1     388.0 129213 1695.9
+ SMIC           1       4.3 129597 1696.7

Step:  AIC=1673.48
IPA ~ exportations

                Df Sum of Sq    RSS    AIC
+ CDD            1    4509.8 114577 1664.9
+ precipitation  1    4286.2 114801 1665.4
+ petrole        1    3708.8 115378 1666.8
&lt;none&gt;                       119087 1673.5
+ temperature    1     526.8 118560 1674.3
+ taux_change    1     294.5 118792 1674.8
+ importations   1     277.5 118809 1674.8
+ SMIC           1      36.9 119050 1675.4

Step:  AIC=1664.86
IPA ~ exportations + CDD

                Df Sum of Sq    RSS    AIC
+ petrole        1    3654.2 110923 1658.0
+ precipitation  1    1121.9 113455 1664.2
&lt;none&gt;                       114577 1664.9
+ taux_change    1     394.5 114182 1665.9
+ importations   1     341.6 114235 1666.0
+ SMIC           1      13.6 114563 1666.8
+ temperature    1       0.1 114577 1666.9

Step:  AIC=1657.95
IPA ~ exportations + CDD + petrole

                Df Sum of Sq    RSS    AIC
+ taux_change    1   1630.73 109292 1655.9
+ precipitation  1   1545.06 109378 1656.1
&lt;none&gt;                       110923 1658.0
+ importations   1    220.08 110703 1659.4
+ temperature    1     33.87 110889 1659.9
+ SMIC           1     27.01 110896 1659.9

Step:  AIC=1655.88
IPA ~ exportations + CDD + petrole + taux_change

                Df Sum of Sq    RSS    AIC
+ precipitation  1   1608.85 107683 1653.8
&lt;none&gt;                       109292 1655.9
+ importations   1    239.66 109052 1657.3
+ temperature    1     26.53 109265 1657.8
+ SMIC           1      0.14 109292 1657.9

Step:  AIC=1653.8
IPA ~ exportations + CDD + petrole + taux_change + precipitation

               Df Sum of Sq    RSS    AIC
&lt;none&gt;                      107683 1653.8
+ importations  1   150.885 107532 1655.4
+ temperature   1    77.809 107605 1655.6
+ SMIC          1     3.351 107680 1655.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode descendante</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>step2 <span class="ot">&lt;-</span> <span class="fu">step</span>(modele1,<span class="at">data=</span>stationnaire_data,<span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1659.26
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    SMIC + precipitation + temperature

                Df Sum of Sq    RSS    AIC
- SMIC           1       3.4 107474 1657.3
- temperature    1      58.9 107530 1657.4
- importations   1     130.1 107601 1657.6
&lt;none&gt;                       107471 1659.3
- CDD            1    1240.9 108712 1660.4
- precipitation  1    1542.9 109014 1661.2
- taux_change    1    1680.4 109151 1661.5
- petrole        1    5179.2 112650 1670.2
- exportations   1    7852.3 115323 1676.7

Step:  AIC=1657.26
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    precipitation + temperature

                Df Sum of Sq    RSS    AIC
- temperature    1      58.0 107532 1655.4
- importations   1     131.1 107605 1655.6
&lt;none&gt;                       107474 1657.3
- CDD            1    1240.1 108714 1658.4
- precipitation  1    1539.4 109014 1659.2
- taux_change    1    1722.5 109197 1659.6
- petrole        1    5182.5 112657 1668.2
- exportations   1    7890.1 115364 1674.8

Step:  AIC=1655.41
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    precipitation

                Df Sum of Sq    RSS    AIC
- importations   1     150.9 107683 1653.8
&lt;none&gt;                       107532 1655.4
- CDD            1    1194.3 108727 1656.5
- precipitation  1    1520.1 109052 1657.3
- taux_change    1    1708.8 109241 1657.8
- petrole        1    5262.3 112795 1666.5
- exportations   1    8068.0 115600 1673.3

Step:  AIC=1653.8
IPA ~ CDD + exportations + petrole + taux_change + precipitation

                Df Sum of Sq    RSS    AIC
&lt;none&gt;                       107683 1653.8
- CDD            1    1142.0 108825 1654.7
- precipitation  1    1608.9 109292 1655.9
- taux_change    1    1694.5 109378 1656.1
- petrole        1    5390.6 113074 1665.2
- exportations   1    8176.7 115860 1671.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode double</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co">#méthode dans les 2 sens</span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>step3 <span class="ot">&lt;-</span> <span class="fu">step</span>(modele0,<span class="at">scope=</span><span class="fu">list</span>(<span class="at">upper=</span>modele1),<span class="at">data=</span>stationnaire_data,<span class="at">direction=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1694.75
IPA ~ 1

                Df Sum of Sq    RSS    AIC
+ exportations   1   10514.2 119087 1673.5
+ CDD            1    7482.6 122118 1680.4
+ precipitation  1    5178.7 124422 1685.5
+ petrole        1    3258.2 126343 1689.8
+ temperature    1    2522.9 127078 1691.3
&lt;none&gt;                       129601 1694.8
+ taux_change    1     396.9 129204 1695.9
+ importations   1     388.0 129213 1695.9
+ SMIC           1       4.3 129597 1696.7

Step:  AIC=1673.48
IPA ~ exportations

                Df Sum of Sq    RSS    AIC
+ CDD            1    4509.8 114577 1664.9
+ precipitation  1    4286.2 114801 1665.4
+ petrole        1    3708.8 115378 1666.8
&lt;none&gt;                       119087 1673.5
+ temperature    1     526.8 118560 1674.3
+ taux_change    1     294.5 118792 1674.8
+ importations   1     277.5 118809 1674.8
+ SMIC           1      36.9 119050 1675.4
- exportations   1   10514.2 129601 1694.8

Step:  AIC=1664.86
IPA ~ exportations + CDD

                Df Sum of Sq    RSS    AIC
+ petrole        1    3654.2 110923 1658.0
+ precipitation  1    1121.9 113455 1664.2
&lt;none&gt;                       114577 1664.9
+ taux_change    1     394.5 114182 1665.9
+ importations   1     341.6 114235 1666.0
+ SMIC           1      13.6 114563 1666.8
+ temperature    1       0.1 114577 1666.9
- CDD            1    4509.8 119087 1673.5
- exportations   1    7541.5 122118 1680.4

Step:  AIC=1657.95
IPA ~ exportations + CDD + petrole

                Df Sum of Sq    RSS    AIC
+ taux_change    1    1630.7 109292 1655.9
+ precipitation  1    1545.1 109378 1656.1
&lt;none&gt;                       110923 1658.0
+ importations   1     220.1 110703 1659.4
+ temperature    1      33.9 110889 1659.9
+ SMIC           1      27.0 110896 1659.9
- petrole        1    3654.2 114577 1664.9
- CDD            1    4455.3 115378 1666.8
- exportations   1    7928.8 118852 1674.9

Step:  AIC=1655.88
IPA ~ exportations + CDD + petrole + taux_change

                Df Sum of Sq    RSS    AIC
+ precipitation  1    1608.9 107683 1653.8
&lt;none&gt;                       109292 1655.9
+ importations   1     239.7 109052 1657.3
+ temperature    1      26.5 109265 1657.8
+ SMIC           1       0.1 109292 1657.9
- taux_change    1    1630.7 110923 1658.0
- CDD            1    4665.5 113958 1665.4
- petrole        1    4890.5 114182 1665.9
- exportations   1    7751.2 117043 1672.7

Step:  AIC=1653.8
IPA ~ exportations + CDD + petrole + taux_change + precipitation

                Df Sum of Sq    RSS    AIC
&lt;none&gt;                       107683 1653.8
- CDD            1    1142.0 108825 1654.7
+ importations   1     150.9 107532 1655.4
+ temperature    1      77.8 107605 1655.6
+ SMIC           1       3.4 107680 1655.8
- precipitation  1    1608.9 109292 1655.9
- taux_change    1    1694.5 109378 1656.1
- petrole        1    5390.6 113074 1665.2
- exportations   1    8176.7 115860 1671.9</code></pre>
</div>
</div>
</section>
</section>
<section id="modeles" class="level1">
<h1>MODELES</h1>
<p>Après les méthodes de sélections les variables IPA ~ exportations + CDD + petrole + taux_change + precipitation</p>
<section id="modèle" class="level2">
<h2 class="anchored" data-anchor-id="modèle">1. Modèle</h2>
<p>1 retenue</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>lm_model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA <span class="sc">~</span> exportations <span class="sc">+</span> CDD <span class="sc">+</span> petrole <span class="sc">+</span> taux_change <span class="sc">+</span> precipitation, <span class="at">data=</span>stationnaire_data)</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ exportations + CDD + petrole + taux_change + 
    precipitation, data = stationnaire_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-62.049  -9.874  -1.524   7.272 114.365 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    2.78407   18.61192   0.150 0.881204    
exportations   0.22733    0.05030   4.520 9.29e-06 ***
CDD            1.57990    0.93540   1.689 0.092376 .  
petrole        0.77049    0.20997   3.670 0.000293 ***
taux_change   20.96618   10.19045   2.057 0.040608 *  
precipitation -0.16106    0.08034  -2.005 0.045992 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 20.01 on 269 degrees of freedom
Multiple R-squared:  0.1691,    Adjusted R-squared:  0.1537 
F-statistic: 10.95 on 5 and 269 DF,  p-value: 1.316e-09</code></pre>
</div>
</div>
<section id="hypothèses" class="level3">
<h3 class="anchored" data-anchor-id="hypothèses">Hypothèses</h3>
<p>Test de normalité des résidus</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Résidus</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>residus <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm_model1)</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residus, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residus), <span class="at">sd =</span> <span class="fu">sd</span>(residus))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residus
D = 0.11327, p-value = 0.001723
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>p-value = 0.001723, Refus de l’hypothèse de normalité des résidus au seuil de risque de 5%</p>
<p>Test d’homoscédasticité des résidus</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Breusch-Pagan pour l'hétéroscédasticité</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(lm_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  lm_model1
BP = 26.02, df = 5, p-value = 8.844e-05</code></pre>
</div>
</div>
<p>p-value = 8.844e-05, Refus de l’hypothèse d’homoscédacticité des résidus au seuil de risque de 5%</p>
<p>Forme fonctionnelle</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test RESET</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">reset</span>(lm_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  lm_model1
RESET = 6.6669, df1 = 2, df2 = 267, p-value = 0.001495</code></pre>
</div>
</div>
<p>p-value = 0.001495; Forme fonctionnelle linéaire du modèle spécifié acceptée au seuil de 5%</p>
<p>Analyse des observations influençant l’estimation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance de Cook pour identifier les points influents</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(lm_model1), <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">main =</span> <span class="st">"Distance de Cook"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>multicollinéarité</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lm_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> exportations           CDD       petrole   taux_change precipitation 
     1.048992      1.531173      1.115762      1.107182      1.482521 </code></pre>
</div>
</div>
<p>Autocorrelation de résidus</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(lm_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 109.93, df = 10, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>p-value &lt; 2.2e-16. il existe des preuves significatives d’auto-corrélation résiduelle dans les données.</p>
</section>
</section>
<section id="modèle-2-différencié---logarithmique" class="level2">
<h2 class="anchored" data-anchor-id="modèle-2-différencié---logarithmique">2. Modèle 2: différencié - logarithmique</h2>
<p>Dans ce model nous appliquons le logarithme avant la différenciation p</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>d_l_IPA <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(data_adj<span class="sc">$</span>IPA), <span class="at">differences =</span> <span class="dv">1</span>)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ts</span>(d_l_IPA))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(d_l_IPA) <span class="co"># on verifie stationnarité </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in adf.test(d_l_IPA): p-value smaller than printed p-value</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  d_l_IPA
Dickey-Fuller = -5.2389, Lag order = 6, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creation df avec la dif du log de ipa</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>st2_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> data_adj<span class="sc">$</span>Date[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">IPA =</span> d_l_IPA,  </span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CDD =</span> CDD_deseason[<span class="sc">-</span><span class="dv">1</span>],  </span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">importations =</span> importation_diff,</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">exportations =</span> exportations_deseason[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">petrole =</span> petrole_diff, </span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">taux_change =</span> taux_change_diff,  </span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">SMIC =</span> ts_SMIC[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">precipitation =</span> precipitations_deseason[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> temperature_deseason[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb290-13"><a href="#cb290-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb290-14"><a href="#cb290-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-15"><a href="#cb290-15" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation modele avec ipa differencié et log</span></span>
<span id="cb290-16"><a href="#cb290-16" aria-hidden="true" tabindex="-1"></a>modele1_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA <span class="sc">~</span> CDD <span class="sc">+</span>  importations <span class="sc">+</span> exportations <span class="sc">+</span>  petrole <span class="sc">+</span>  taux_change <span class="sc">+</span> SMIC <span class="sc">+</span> precipitation <span class="sc">+</span> temperature, <span class="at">data=</span>st2_data)</span>
<span id="cb290-17"><a href="#cb290-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele1_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ CDD + importations + exportations + petrole + 
    taux_change + SMIC + precipitation + temperature, data = st2_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.053209 -0.013832 -0.001854  0.010430  0.074676 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    4.582e-02  2.275e-02   2.014 0.045005 *  
CDD            7.037e-05  1.020e-03   0.069 0.945062    
importations   5.464e-05  8.959e-05   0.610 0.542481    
exportations   1.068e-04  5.603e-05   1.907 0.057611 .  
petrole        8.162e-04  2.266e-04   3.602 0.000376 ***
taux_change    4.257e-02  1.104e-02   3.856 0.000144 ***
SMIC          -3.741e-05  5.717e-05  -0.654 0.513451    
precipitation -2.346e-04  9.237e-05  -2.540 0.011646 *  
temperature   -3.939e-03  3.654e-03  -1.078 0.281995    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02151 on 266 degrees of freedom
Multiple R-squared:  0.1119,    Adjusted R-squared:  0.08523 
F-statistic: 4.191 on 8 and 266 DF,  p-value: 9.593e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step : Sélection des variables explicatives significatives (modèle linéaire = modele1 )</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>modele0_2 <span class="ot">&lt;-</span> (<span class="fu">lm</span>(IPA<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>st2_data))</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele0_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ 1, data = st2_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.060967 -0.014968 -0.002519  0.011062  0.082152 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.008686   0.001356   6.403 6.58e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02249 on 274 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode ascendante</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele0_2, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>modele0_2, <span class="at">upper=</span>modele1_2), <span class="at">data=</span>st2_data, <span class="at">direction=</span><span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-2085.99
IPA ~ 1

                Df Sum of Sq     RSS     AIC
+ taux_change    1 0.0035569 0.13508 -2091.1
+ precipitation  1 0.0032765 0.13536 -2090.6
+ petrole        1 0.0027049 0.13593 -2089.4
+ exportations   1 0.0016087 0.13703 -2087.2
+ CDD            1 0.0015048 0.13713 -2087.0
&lt;none&gt;                       0.13864 -2086.0
+ importations   1 0.0004699 0.13817 -2084.9
+ temperature    1 0.0001474 0.13849 -2084.3
+ SMIC           1 0.0001195 0.13852 -2084.2

Step:  AIC=-2091.13
IPA ~ taux_change

                Df Sum of Sq     RSS     AIC
+ petrole        1 0.0054703 0.12961 -2100.5
+ precipitation  1 0.0033626 0.13172 -2096.1
+ CDD            1 0.0016667 0.13341 -2092.6
+ exportations   1 0.0014833 0.13359 -2092.2
&lt;none&gt;                       0.13508 -2091.1
+ importations   1 0.0005565 0.13452 -2090.3
+ SMIC           1 0.0003469 0.13473 -2089.8
+ temperature    1 0.0000998 0.13498 -2089.3

Step:  AIC=-2100.5
IPA ~ taux_change + petrole

                Df Sum of Sq     RSS     AIC
+ precipitation  1 0.0041454 0.12546 -2107.4
+ CDD            1 0.0017392 0.12787 -2102.2
+ exportations   1 0.0016606 0.12795 -2102.1
&lt;none&gt;                       0.12961 -2100.5
+ importations   1 0.0003904 0.12922 -2099.3
+ SMIC           1 0.0003829 0.12923 -2099.3
+ temperature    1 0.0002855 0.12932 -2099.1

Step:  AIC=-2107.44
IPA ~ taux_change + petrole + precipitation

               Df  Sum of Sq     RSS     AIC
+ exportations  1 0.00135287 0.12411 -2108.4
&lt;none&gt;                       0.12546 -2107.4
+ importations  1 0.00026866 0.12519 -2106.0
+ temperature   1 0.00019464 0.12527 -2105.9
+ SMIC          1 0.00016345 0.12530 -2105.8
+ CDD           1 0.00004282 0.12542 -2105.5

Step:  AIC=-2108.42
IPA ~ taux_change + petrole + precipitation + exportations

               Df  Sum of Sq     RSS     AIC
&lt;none&gt;                       0.12411 -2108.4
+ temperature   1 0.00062530 0.12348 -2107.8
+ importations  1 0.00023504 0.12387 -2106.9
+ SMIC          1 0.00020702 0.12390 -2106.9
+ CDD           1 0.00000092 0.12411 -2106.4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ taux_change + petrole + precipitation + exportations, 
    data = st2_data)

Coefficients:
  (Intercept)    taux_change        petrole  precipitation   exportations  
    3.342e-02      4.133e-02      8.381e-04     -2.054e-04      9.054e-05  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode descendante</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele1_2,<span class="at">data=</span>st2_data,<span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-2102.63
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    SMIC + precipitation + temperature

                Df Sum of Sq     RSS     AIC
- CDD            1 0.0000022 0.12312 -2104.6
- importations   1 0.0001721 0.12329 -2104.2
- SMIC           1 0.0001982 0.12331 -2104.2
- temperature    1 0.0005379 0.12366 -2103.4
&lt;none&gt;                       0.12312 -2102.6
- exportations   1 0.0016830 0.12480 -2100.9
- precipitation  1 0.0029868 0.12610 -2098.0
- petrole        1 0.0060068 0.12912 -2091.5
- taux_change    1 0.0068828 0.13000 -2089.7

Step:  AIC=-2104.63
IPA ~ importations + exportations + petrole + taux_change + SMIC + 
    precipitation + temperature

                Df Sum of Sq     RSS     AIC
- importations   1 0.0001705 0.12329 -2106.2
- SMIC           1 0.0002043 0.12332 -2106.2
- temperature    1 0.0005374 0.12366 -2105.4
&lt;none&gt;                       0.12312 -2104.6
- exportations   1 0.0017558 0.12487 -2102.7
- precipitation  1 0.0039845 0.12710 -2097.9
- petrole        1 0.0060420 0.12916 -2093.4
- taux_change    1 0.0068808 0.13000 -2091.7

Step:  AIC=-2106.25
IPA ~ exportations + petrole + taux_change + SMIC + precipitation + 
    temperature

                Df Sum of Sq     RSS     AIC
- SMIC           1 0.0001947 0.12348 -2107.8
- temperature    1 0.0006130 0.12390 -2106.9
&lt;none&gt;                       0.12329 -2106.2
- exportations   1 0.0018247 0.12512 -2104.2
- precipitation  1 0.0041861 0.12748 -2099.1
- petrole        1 0.0061623 0.12945 -2094.8
- taux_change    1 0.0068525 0.13014 -2093.4

Step:  AIC=-2107.81
IPA ~ exportations + petrole + taux_change + precipitation + 
    temperature

                Df Sum of Sq     RSS     AIC
- temperature    1 0.0006253 0.12411 -2108.4
&lt;none&gt;                       0.12348 -2107.8
- exportations   1 0.0017835 0.12527 -2105.9
- precipitation  1 0.0044267 0.12791 -2100.1
- petrole        1 0.0061497 0.12963 -2096.4
- taux_change    1 0.0066743 0.13016 -2095.3

Step:  AIC=-2108.42
IPA ~ exportations + petrole + taux_change + precipitation

                Df Sum of Sq     RSS     AIC
&lt;none&gt;                       0.12411 -2108.4
- exportations   1 0.0013529 0.12546 -2107.4
- precipitation  1 0.0038376 0.12795 -2102.1
- petrole        1 0.0063937 0.13050 -2096.6
- taux_change    1 0.0065890 0.13070 -2096.2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ exportations + petrole + taux_change + precipitation, 
    data = st2_data)

Coefficients:
  (Intercept)   exportations        petrole    taux_change  precipitation  
    3.342e-02      9.054e-05      8.381e-04      4.133e-02     -2.054e-04  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode double</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="co">#méthode dans les 2 sens</span></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele0_2,<span class="at">scope=</span><span class="fu">list</span>(<span class="at">upper=</span>modele1_2),<span class="at">data=</span>st2_data,<span class="at">direction=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-2085.99
IPA ~ 1

                Df Sum of Sq     RSS     AIC
+ taux_change    1 0.0035569 0.13508 -2091.1
+ precipitation  1 0.0032765 0.13536 -2090.6
+ petrole        1 0.0027049 0.13593 -2089.4
+ exportations   1 0.0016087 0.13703 -2087.2
+ CDD            1 0.0015048 0.13713 -2087.0
&lt;none&gt;                       0.13864 -2086.0
+ importations   1 0.0004699 0.13817 -2084.9
+ temperature    1 0.0001474 0.13849 -2084.3
+ SMIC           1 0.0001195 0.13852 -2084.2

Step:  AIC=-2091.13
IPA ~ taux_change

                Df Sum of Sq     RSS     AIC
+ petrole        1 0.0054703 0.12961 -2100.5
+ precipitation  1 0.0033626 0.13172 -2096.1
+ CDD            1 0.0016667 0.13341 -2092.6
+ exportations   1 0.0014833 0.13359 -2092.2
&lt;none&gt;                       0.13508 -2091.1
+ importations   1 0.0005565 0.13452 -2090.3
+ SMIC           1 0.0003469 0.13473 -2089.8
+ temperature    1 0.0000998 0.13498 -2089.3
- taux_change    1 0.0035569 0.13864 -2086.0

Step:  AIC=-2100.5
IPA ~ taux_change + petrole

                Df Sum of Sq     RSS     AIC
+ precipitation  1 0.0041454 0.12546 -2107.4
+ CDD            1 0.0017392 0.12787 -2102.2
+ exportations   1 0.0016606 0.12795 -2102.1
&lt;none&gt;                       0.12961 -2100.5
+ importations   1 0.0003904 0.12922 -2099.3
+ SMIC           1 0.0003829 0.12923 -2099.3
+ temperature    1 0.0002855 0.12932 -2099.1
- petrole        1 0.0054703 0.13508 -2091.1
- taux_change    1 0.0063223 0.13593 -2089.4

Step:  AIC=-2107.44
IPA ~ taux_change + petrole + precipitation

                Df Sum of Sq     RSS     AIC
+ exportations   1 0.0013529 0.12411 -2108.4
&lt;none&gt;                       0.12546 -2107.4
+ importations   1 0.0002687 0.12519 -2106.0
+ temperature    1 0.0001946 0.12527 -2105.9
+ SMIC           1 0.0001635 0.12530 -2105.8
+ CDD            1 0.0000428 0.12542 -2105.5
- precipitation  1 0.0041454 0.12961 -2100.5
- petrole        1 0.0062530 0.13172 -2096.1
- taux_change    1 0.0067044 0.13217 -2095.1

Step:  AIC=-2108.42
IPA ~ taux_change + petrole + precipitation + exportations

                Df Sum of Sq     RSS     AIC
&lt;none&gt;                       0.12411 -2108.4
+ temperature    1 0.0006253 0.12348 -2107.8
- exportations   1 0.0013529 0.12546 -2107.4
+ importations   1 0.0002350 0.12387 -2106.9
+ SMIC           1 0.0002070 0.12390 -2106.9
+ CDD            1 0.0000009 0.12411 -2106.4
- precipitation  1 0.0038376 0.12795 -2102.1
- petrole        1 0.0063937 0.13050 -2096.6
- taux_change    1 0.0065890 0.13070 -2096.2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ taux_change + petrole + precipitation + exportations, 
    data = st2_data)

Coefficients:
  (Intercept)    taux_change        petrole  precipitation   exportations  
    3.342e-02      4.133e-02      8.381e-04     -2.054e-04      9.054e-05  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MODELO 3 RETENUE</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>lm_model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA <span class="sc">~</span> taux_change <span class="sc">+</span> petrole <span class="sc">+</span> precipitation <span class="sc">+</span> exportations, </span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> st2_data)</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ taux_change + petrole + precipitation + exportations, 
    data = st2_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.053072 -0.013313 -0.002177  0.009744  0.072178 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    3.342e-02  1.095e-02   3.053 0.002494 ** 
taux_change    4.133e-02  1.092e-02   3.786 0.000189 ***
petrole        8.381e-04  2.247e-04   3.730 0.000234 ***
precipitation -2.054e-04  7.110e-05  -2.889 0.004173 ** 
exportations   9.054e-05  5.277e-05   1.716 0.087389 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02144 on 270 degrees of freedom
Multiple R-squared:  0.1048,    Adjusted R-squared:  0.09151 
F-statistic:   7.9 on 4 and 270 DF,  p-value: 4.911e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="do">## TESTS </span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>residus2 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm_model2)</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residus2, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residus2), <span class="at">sd =</span> <span class="fu">sd</span>(residus2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residus2
D = 0.075036, p-value = 0.09039
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(lm_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  lm_model2
BP = 3.7142, df = 4, p-value = 0.4461</code></pre>
</div>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reset</span>(lm_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  lm_model2
RESET = 0.21788, df1 = 2, df2 = 268, p-value = 0.8044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lm_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  taux_change       petrole precipitation  exportations 
     1.106656      1.113121      1.011154      1.005594 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(lm_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 85.459, df = 10, p-value = 4.237e-14</code></pre>
</div>
</div>
<p>Le modèle 3 inclut une variable de temps pour capturer la tendance déterministe. Cela permet de modéliser explicitement les effets de la tendance dans les données et peut aider à réduire l’autocorrélation dans les résidus.</p>
</section>
<section id="modèle-3-index-temporel" class="level2">
<h2 class="anchored" data-anchor-id="modèle-3-index-temporel">3. Modèle 3 index temporel</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout d'un index temporel</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>st3_data <span class="ot">&lt;-</span> st2_data</span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>st3_data<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(st3_data)</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de régression avec la variable de temps</span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a>modele1_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA <span class="sc">~</span> CDD <span class="sc">+</span>  importations <span class="sc">+</span> exportations <span class="sc">+</span>  petrole <span class="sc">+</span>  taux_change <span class="sc">+</span> SMIC <span class="sc">+</span> precipitation <span class="sc">+</span> temperature<span class="sc">+</span> time, <span class="at">data =</span> st3_data)</span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele1_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ CDD + importations + exportations + petrole + 
    taux_change + SMIC + precipitation + temperature + time, 
    data = st3_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.051688 -0.013833 -0.002295  0.010354  0.074510 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    3.707e-02  2.287e-02   1.621 0.106247    
CDD            3.555e-04  1.019e-03   0.349 0.727494    
importations   4.968e-05  8.887e-05   0.559 0.576620    
exportations   2.756e-04  9.090e-05   3.032 0.002672 ** 
petrole        8.462e-04  2.250e-04   3.760 0.000209 ***
taux_change    4.474e-02  1.099e-02   4.073 6.14e-05 ***
SMIC          -4.162e-05  5.672e-05  -0.734 0.463764    
precipitation -2.047e-04  9.248e-05  -2.214 0.027695 *  
temperature   -9.079e-04  3.847e-03  -0.236 0.813582    
time          -7.058e-05  3.009e-05  -2.346 0.019739 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02133 on 265 degrees of freedom
Multiple R-squared:   0.13, Adjusted R-squared:  0.1004 
F-statistic:   4.4 on 9 and 265 DF,  p-value: 2.248e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>modele0_3 <span class="ot">&lt;-</span> (<span class="fu">lm</span>((IPA)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>st3_data))</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele0_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (IPA) ~ 1, data = st3_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.060967 -0.014968 -0.002519  0.011062  0.082152 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.008686   0.001356   6.403 6.58e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02249 on 274 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode ascendante</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele0_3, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>modele0_3, <span class="at">upper=</span>modele1_3), <span class="at">data=</span>st3_data, <span class="at">direction=</span><span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-2085.99
(IPA) ~ 1

                Df Sum of Sq     RSS     AIC
+ taux_change    1 0.0035569 0.13508 -2091.1
+ precipitation  1 0.0032765 0.13536 -2090.6
+ petrole        1 0.0027049 0.13593 -2089.4
+ exportations   1 0.0016087 0.13703 -2087.2
+ CDD            1 0.0015048 0.13713 -2087.0
&lt;none&gt;                       0.13864 -2086.0
+ importations   1 0.0004699 0.13817 -2084.9
+ temperature    1 0.0001474 0.13849 -2084.3
+ SMIC           1 0.0001195 0.13852 -2084.2
+ time           1 0.0000569 0.13858 -2084.1

Step:  AIC=-2091.13
(IPA) ~ taux_change

                Df Sum of Sq     RSS     AIC
+ petrole        1 0.0054703 0.12961 -2100.5
+ precipitation  1 0.0033626 0.13172 -2096.1
+ CDD            1 0.0016667 0.13341 -2092.6
+ exportations   1 0.0014833 0.13359 -2092.2
&lt;none&gt;                       0.13508 -2091.1
+ importations   1 0.0005565 0.13452 -2090.3
+ SMIC           1 0.0003469 0.13473 -2089.8
+ temperature    1 0.0000998 0.13498 -2089.3
+ time           1 0.0000143 0.13506 -2089.2

Step:  AIC=-2100.5
(IPA) ~ taux_change + petrole

                Df Sum of Sq     RSS     AIC
+ precipitation  1 0.0041454 0.12546 -2107.4
+ CDD            1 0.0017392 0.12787 -2102.2
+ exportations   1 0.0016606 0.12795 -2102.1
&lt;none&gt;                       0.12961 -2100.5
+ importations   1 0.0003904 0.12922 -2099.3
+ SMIC           1 0.0003829 0.12923 -2099.3
+ temperature    1 0.0002855 0.12932 -2099.1
+ time           1 0.0000179 0.12959 -2098.5

Step:  AIC=-2107.44
(IPA) ~ taux_change + petrole + precipitation

               Df  Sum of Sq     RSS     AIC
+ exportations  1 0.00135287 0.12411 -2108.4
&lt;none&gt;                       0.12546 -2107.4
+ importations  1 0.00026866 0.12519 -2106.0
+ temperature   1 0.00019464 0.12527 -2105.9
+ SMIC          1 0.00016345 0.12530 -2105.8
+ CDD           1 0.00004282 0.12542 -2105.5
+ time          1 0.00000487 0.12546 -2105.4

Step:  AIC=-2108.42
(IPA) ~ taux_change + petrole + precipitation + exportations

               Df  Sum of Sq     RSS     AIC
+ time          1 0.00300963 0.12110 -2113.2
&lt;none&gt;                       0.12411 -2108.4
+ temperature   1 0.00062530 0.12348 -2107.8
+ importations  1 0.00023504 0.12387 -2106.9
+ SMIC          1 0.00020702 0.12390 -2106.9
+ CDD           1 0.00000092 0.12411 -2106.4

Step:  AIC=-2113.17
(IPA) ~ taux_change + petrole + precipitation + exportations + 
    time

               Df  Sum of Sq     RSS     AIC
&lt;none&gt;                       0.12110 -2113.2
+ SMIC          1 2.6657e-04 0.12083 -2111.8
+ importations  1 1.3613e-04 0.12096 -2111.5
+ CDD           1 6.2070e-05 0.12104 -2111.3
+ temperature   1 3.7371e-05 0.12106 -2111.3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (IPA) ~ taux_change + petrole + precipitation + 
    exportations + time, data = st3_data)

Coefficients:
  (Intercept)    taux_change        petrole  precipitation   exportations  
    3.606e-02      4.359e-02      8.601e-04     -2.207e-04      2.781e-04  
         time  
   -7.182e-05  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode descendante</span></span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele1_3,<span class="at">data=</span>st3_data,<span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-2106.28
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    SMIC + precipitation + temperature + time

                Df Sum of Sq     RSS     AIC
- temperature    1 0.0000254 0.12064 -2108.2
- CDD            1 0.0000554 0.12067 -2108.2
- importations   1 0.0001422 0.12076 -2108.0
- SMIC           1 0.0002450 0.12086 -2107.7
&lt;none&gt;                       0.12061 -2106.3
- precipitation  1 0.0022306 0.12284 -2103.2
- time           1 0.0025039 0.12312 -2102.6
- exportations   1 0.0041834 0.12480 -2098.9
- petrole        1 0.0064351 0.12705 -2094.0
- taux_change    1 0.0075490 0.12816 -2091.6

Step:  AIC=-2108.22
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    SMIC + precipitation + time

                Df Sum of Sq     RSS     AIC
- CDD            1 0.0000503 0.12069 -2110.1
- importations   1 0.0001542 0.12079 -2109.9
- SMIC           1 0.0002519 0.12089 -2109.7
&lt;none&gt;                       0.12064 -2108.2
- precipitation  1 0.0023802 0.12302 -2104.8
- time           1 0.0030165 0.12366 -2103.4
- exportations   1 0.0043266 0.12497 -2100.5
- petrole        1 0.0065290 0.12717 -2095.7
- taux_change    1 0.0075587 0.12820 -2093.5

Step:  AIC=-2110.11
IPA ~ importations + exportations + petrole + taux_change + SMIC + 
    precipitation + time

                Df Sum of Sq     RSS     AIC
- importations   1 0.0001447 0.12083 -2111.8
- SMIC           1 0.0002752 0.12096 -2111.5
&lt;none&gt;                       0.12069 -2110.1
- time           1 0.0029679 0.12366 -2105.4
- precipitation  1 0.0040219 0.12471 -2103.1
- exportations   1 0.0043276 0.12502 -2102.4
- petrole        1 0.0065981 0.12729 -2097.5
- taux_change    1 0.0075334 0.12822 -2095.5

Step:  AIC=-2111.78
IPA ~ exportations + petrole + taux_change + SMIC + precipitation + 
    time

                Df Sum of Sq     RSS     AIC
- SMIC           1 0.0002666 0.12110 -2113.2
&lt;none&gt;                       0.12083 -2111.8
- time           1 0.0030692 0.12390 -2106.9
- precipitation  1 0.0041255 0.12496 -2104.6
- exportations   1 0.0044615 0.12529 -2103.8
- petrole        1 0.0067392 0.12757 -2098.9
- taux_change    1 0.0075131 0.12835 -2097.2

Step:  AIC=-2113.17
IPA ~ exportations + petrole + taux_change + precipitation + 
    time

                Df Sum of Sq     RSS     AIC
&lt;none&gt;                       0.12110 -2113.2
- time           1 0.0030096 0.12411 -2108.4
- exportations   1 0.0043576 0.12546 -2105.4
- precipitation  1 0.0043997 0.12550 -2105.4
- petrole        1 0.0067228 0.12782 -2100.3
- taux_change    1 0.0072794 0.12838 -2099.1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ exportations + petrole + taux_change + precipitation + 
    time, data = st3_data)

Coefficients:
  (Intercept)   exportations        petrole    taux_change  precipitation  
    3.606e-02      2.781e-04      8.601e-04      4.359e-02     -2.207e-04  
         time  
   -7.182e-05  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode double</span></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="co">#méthode dans les 2 sens</span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele0_3,<span class="at">scope=</span><span class="fu">list</span>(<span class="at">upper=</span>modele1_3),<span class="at">data=</span>st3_data,<span class="at">direction=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-2085.99
(IPA) ~ 1

                Df Sum of Sq     RSS     AIC
+ taux_change    1 0.0035569 0.13508 -2091.1
+ precipitation  1 0.0032765 0.13536 -2090.6
+ petrole        1 0.0027049 0.13593 -2089.4
+ exportations   1 0.0016087 0.13703 -2087.2
+ CDD            1 0.0015048 0.13713 -2087.0
&lt;none&gt;                       0.13864 -2086.0
+ importations   1 0.0004699 0.13817 -2084.9
+ temperature    1 0.0001474 0.13849 -2084.3
+ SMIC           1 0.0001195 0.13852 -2084.2
+ time           1 0.0000569 0.13858 -2084.1

Step:  AIC=-2091.13
(IPA) ~ taux_change

                Df Sum of Sq     RSS     AIC
+ petrole        1 0.0054703 0.12961 -2100.5
+ precipitation  1 0.0033626 0.13172 -2096.1
+ CDD            1 0.0016667 0.13341 -2092.6
+ exportations   1 0.0014833 0.13359 -2092.2
&lt;none&gt;                       0.13508 -2091.1
+ importations   1 0.0005565 0.13452 -2090.3
+ SMIC           1 0.0003469 0.13473 -2089.8
+ temperature    1 0.0000998 0.13498 -2089.3
+ time           1 0.0000143 0.13506 -2089.2
- taux_change    1 0.0035569 0.13864 -2086.0

Step:  AIC=-2100.5
(IPA) ~ taux_change + petrole

                Df Sum of Sq     RSS     AIC
+ precipitation  1 0.0041454 0.12546 -2107.4
+ CDD            1 0.0017392 0.12787 -2102.2
+ exportations   1 0.0016606 0.12795 -2102.1
&lt;none&gt;                       0.12961 -2100.5
+ importations   1 0.0003904 0.12922 -2099.3
+ SMIC           1 0.0003829 0.12923 -2099.3
+ temperature    1 0.0002855 0.12932 -2099.1
+ time           1 0.0000179 0.12959 -2098.5
- petrole        1 0.0054703 0.13508 -2091.1
- taux_change    1 0.0063223 0.13593 -2089.4

Step:  AIC=-2107.44
(IPA) ~ taux_change + petrole + precipitation

                Df Sum of Sq     RSS     AIC
+ exportations   1 0.0013529 0.12411 -2108.4
&lt;none&gt;                       0.12546 -2107.4
+ importations   1 0.0002687 0.12519 -2106.0
+ temperature    1 0.0001946 0.12527 -2105.9
+ SMIC           1 0.0001635 0.12530 -2105.8
+ CDD            1 0.0000428 0.12542 -2105.5
+ time           1 0.0000049 0.12546 -2105.4
- precipitation  1 0.0041454 0.12961 -2100.5
- petrole        1 0.0062530 0.13172 -2096.1
- taux_change    1 0.0067044 0.13217 -2095.1

Step:  AIC=-2108.42
(IPA) ~ taux_change + petrole + precipitation + exportations

                Df Sum of Sq     RSS     AIC
+ time           1 0.0030096 0.12110 -2113.2
&lt;none&gt;                       0.12411 -2108.4
+ temperature    1 0.0006253 0.12348 -2107.8
- exportations   1 0.0013529 0.12546 -2107.4
+ importations   1 0.0002350 0.12387 -2106.9
+ SMIC           1 0.0002070 0.12390 -2106.9
+ CDD            1 0.0000009 0.12411 -2106.4
- precipitation  1 0.0038376 0.12795 -2102.1
- petrole        1 0.0063937 0.13050 -2096.6
- taux_change    1 0.0065890 0.13070 -2096.2

Step:  AIC=-2113.17
(IPA) ~ taux_change + petrole + precipitation + exportations + 
    time

                Df Sum of Sq     RSS     AIC
&lt;none&gt;                       0.12110 -2113.2
+ SMIC           1 0.0002666 0.12083 -2111.8
+ importations   1 0.0001361 0.12096 -2111.5
+ CDD            1 0.0000621 0.12104 -2111.3
+ temperature    1 0.0000374 0.12106 -2111.3
- time           1 0.0030096 0.12411 -2108.4
- exportations   1 0.0043576 0.12546 -2105.4
- precipitation  1 0.0043997 0.12550 -2105.4
- petrole        1 0.0067228 0.12782 -2100.3
- taux_change    1 0.0072794 0.12838 -2099.1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (IPA) ~ taux_change + petrole + precipitation + 
    exportations + time, data = st3_data)

Coefficients:
  (Intercept)    taux_change        petrole  precipitation   exportations  
    3.606e-02      4.359e-02      8.601e-04     -2.207e-04      2.781e-04  
         time  
   -7.182e-05  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># modele 3 </span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>lm_model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> (IPA) <span class="sc">~</span> taux_change <span class="sc">+</span> petrole <span class="sc">+</span> precipitation <span class="sc">+</span> </span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>    exportations <span class="sc">+</span> time, <span class="at">data =</span> st3_data)</span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (IPA) ~ taux_change + petrole + precipitation + 
    exportations + time, data = st3_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.052038 -0.013781 -0.002281  0.010896  0.074264 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    3.606e-02  1.088e-02   3.313  0.00105 ** 
taux_change    4.359e-02  1.084e-02   4.021 7.53e-05 ***
petrole        8.601e-04  2.226e-04   3.864  0.00014 ***
precipitation -2.207e-04  7.061e-05  -3.126  0.00197 ** 
exportations   2.781e-04  8.938e-05   3.111  0.00206 ** 
time          -7.182e-05  2.778e-05  -2.586  0.01025 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02122 on 269 degrees of freedom
Multiple R-squared:  0.1265,    Adjusted R-squared:  0.1102 
F-statistic:  7.79 on 5 and 269 DF,  p-value: 7.282e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="do">## TESTS </span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>residus3 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm_model3)</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residus3, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residus3), <span class="at">sd =</span> <span class="fu">sd</span>(residus3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residus3
D = 0.066946, p-value = 0.1699
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reset</span>(lm_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  lm_model3
RESET = 0.67732, df1 = 2, df2 = 267, p-value = 0.5088</code></pre>
</div>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(lm_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  lm_model3
BP = 4.4605, df = 5, p-value = 0.4852</code></pre>
</div>
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lm_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  taux_change       petrole precipitation  exportations          time 
     1.113852      1.114739      1.018312      2.945289      2.970363 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(lm_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 80.408, df = 10, p-value = 4.177e-13</code></pre>
</div>
</div>
</section>
<section id="modèle-4-tendance-déterministe-corrigée" class="level2">
<h2 class="anchored" data-anchor-id="modèle-4-tendance-déterministe-corrigée">4. Modèle 4 tendance déterministe corrigée</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction pour corriger la tendance déterministe par régression</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>correct_trend <span class="ot">&lt;-</span> <span class="cf">function</span>(series) {</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(series <span class="sc">~</span> <span class="fu">time</span>(series))</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(model)</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Appliquer la correction à chaque variable explicative</span></span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables) {</span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Corriger la tendance déterministe</span></span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a>  corrected_series <span class="ot">&lt;-</span> <span class="fu">correct_trend</span>(stationnaire_data[[var]])</span>
<span id="cb340-10"><a href="#cb340-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ajouter les séries corrigées au data frame</span></span>
<span id="cb340-11"><a href="#cb340-11" aria-hidden="true" tabindex="-1"></a>  stationnaire_data[[<span class="fu">paste</span>(var, <span class="st">"detrended"</span>, <span class="at">sep =</span> <span class="st">"_"</span>)]] <span class="ot">&lt;-</span> corrected_series</span>
<span id="cb340-12"><a href="#cb340-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb340-13"><a href="#cb340-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-14"><a href="#cb340-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Affiche la structure du data frame pour vérifier les changements</span></span>
<span id="cb340-15"><a href="#cb340-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(stationnaire_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   275 obs. of  19 variables:
 $ Date                   : Date, format: "2000-02-01" "2000-03-01" ...
 $ IPA                    : Time-Series  from 2000 to 2023: -2.23 -3.11 -1.59 1.21 6.55 ...
 $ CDD                    : num  8.96 9.14 8.56 11.97 9.15 ...
 $ importations           : Time-Series  from 2000 to 2023: 33.3 -11.7 11.7 14.4 -14 ...
 $ exportations           : num  28.264 -0.125 -2.771 -2.666 7.89 ...
 $ petrole                : Time-Series  from 2000 to 2023: 2.26 -0.29 -4.72 4.97 2.06 ...
 $ taux_change            : Time-Series  from 2000 to 2023: -0.0284 -0.0333 0.0262 0.0597 -0.0196 ...
 $ SMIC                   : num  136 136 151 151 151 151 151 151 151 151 ...
 $ precipitation          : num  163 156 166 135 149 ...
 $ temperature            : num  0.447 0.32 0.527 0.686 0.978 ...
 $ IPA_detrended          : num  -0.267 -1.206 0.25 2.974 8.256 ...
 $ CDD_detrended          : num  -0.426 -0.249 -0.837 2.571 -0.256 ...
 $ precipitation_detrended: num  14.137 6.864 16.623 -13.624 -0.338 ...
 $ temperature_detrended  : num  -0.337 -0.466 -0.261 -0.104 0.185 ...
 $ exportations_detrended : num  12.15 -16.49 -19.39 -19.53 -9.23 ...
 $ importations_detrended : num  32.9 -12.1 11.2 14 -14.5 ...
 $ taux_change_detrended  : num  -0.0273 -0.0323 0.0271 0.0605 -0.0189 ...
 $ SMIC_detrended         : num  -8.06 -8.06 6.94 6.93 6.93 ...
 $ petrole_detrended      : num  1.798 -0.754 -5.185 4.512 1.599 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modele avec toutes les variables, ne sera pas utilisé dans notre analyse - voir méthode STEP</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>modele1_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA_detrended <span class="sc">~</span>  CDD_detrended <span class="sc">+</span>  importations_detrended <span class="sc">+</span> exportations_detrended <span class="sc">+</span>  petrole_detrended <span class="sc">+</span>    taux_change_detrended <span class="sc">+</span> SMIC_detrended <span class="sc">+</span> precipitation_detrended <span class="sc">+</span> temperature_detrended, <span class="at">data=</span>stationnaire_data)</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele1_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA_detrended ~ CDD_detrended + importations_detrended + 
    exportations_detrended + petrole_detrended + taux_change_detrended + 
    SMIC_detrended + precipitation_detrended + temperature_detrended, 
    data = stationnaire_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-62.864  -9.706  -1.702   7.561 114.563 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             -1.012e-15  1.212e+00   0.000 1.000000    
CDD_detrended            1.695e+00  9.600e-01   1.766 0.078523 .  
importations_detrended   4.707e-02  8.372e-02   0.562 0.574421    
exportations_detrended   2.455e-01  8.563e-02   2.867 0.004473 ** 
petrole_detrended        7.605e-01  2.120e-01   3.587 0.000398 ***
taux_change_detrended    2.122e+01  1.035e+01   2.051 0.041281 *  
SMIC_detrended           4.563e-03  5.344e-02   0.085 0.932022    
precipitation_detrended -1.660e-01  8.712e-02  -1.906 0.057771 .  
temperature_detrended   -1.038e+00  3.624e+00  -0.286 0.774761    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 20.1 on 266 degrees of freedom
Multiple R-squared:  0.1187,    Adjusted R-squared:  0.09224 
F-statistic:  4.48 on 8 and 266 DF,  p-value: 4.064e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step : Sélection des variables explicatives significatives (modèle linéaire = modele1_4 )</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>modele0_4 <span class="ot">&lt;-</span> (<span class="fu">lm</span>(IPA_detrended<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>stationnaire_data))</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele0_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA_detrended ~ 1, data = stationnaire_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-69.567  -8.942  -0.549   6.833 125.527 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -7.465e-16  1.272e+00       0        1

Residual standard error: 21.1 on 274 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode ascendante</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">step</span>(modele0_4, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>modele0_4, <span class="at">upper=</span>modele1_4), <span class="at">data=</span>stationnaire_data, <span class="at">direction=</span><span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1677.97
IPA_detrended ~ 1

                          Df Sum of Sq    RSS    AIC
+ CDD_detrended            1    4317.9 117613 1670.0
+ precipitation_detrended  1    4045.9 117885 1670.7
+ petrole_detrended        1    3518.3 118412 1671.9
+ exportations_detrended   1    2899.2 119031 1673.3
&lt;none&gt;                                 121931 1678.0
+ importations_detrended   1     433.1 121497 1679.0
+ temperature_detrended    1     225.7 121705 1679.5
+ taux_change_detrended    1     207.7 121723 1679.5
+ SMIC_detrended           1       9.6 121921 1680.0

Step:  AIC=1670.05
IPA_detrended ~ CDD_detrended

                          Df Sum of Sq    RSS    AIC
+ petrole_detrended        1    3471.6 114141 1663.8
+ exportations_detrended   1    3054.7 114558 1664.8
+ precipitation_detrended  1    1049.9 116563 1669.6
&lt;none&gt;                                 117613 1670.0
+ importations_detrended   1     483.1 117130 1670.9
+ taux_change_detrended    1     319.6 117293 1671.3
+ SMIC_detrended           1      39.6 117573 1672.0
+ temperature_detrended    1      31.3 117581 1672.0

Step:  AIC=1663.82
IPA_detrended ~ CDD_detrended + petrole_detrended

                          Df Sum of Sq    RSS    AIC
+ exportations_detrended   1    3241.0 110900 1657.9
+ precipitation_detrended  1    1445.8 112695 1662.3
+ taux_change_detrended    1    1428.6 112712 1662.3
&lt;none&gt;                                 114141 1663.8
+ importations_detrended   1     343.1 113798 1665.0
+ SMIC_detrended           1      61.4 114080 1665.7
+ temperature_detrended    1       0.3 114141 1665.8

Step:  AIC=1657.89
IPA_detrended ~ CDD_detrended + petrole_detrended + exportations_detrended

                          Df Sum of Sq    RSS    AIC
+ taux_change_detrended    1   1675.90 109224 1655.7
+ precipitation_detrended  1   1537.52 109362 1656.0
&lt;none&gt;                                 110900 1657.9
+ importations_detrended   1    212.47 110688 1659.4
+ temperature_detrended    1     59.16 110841 1659.8
+ SMIC_detrended           1     26.57 110873 1659.8

Step:  AIC=1655.71
IPA_detrended ~ CDD_detrended + petrole_detrended + exportations_detrended + 
    taux_change_detrended

                          Df Sum of Sq    RSS    AIC
+ precipitation_detrended  1   1595.97 107628 1653.7
&lt;none&gt;                                 109224 1655.7
+ importations_detrended   1    225.71 108998 1657.1
+ temperature_detrended    1     66.05 109158 1657.5
+ SMIC_detrended           1      0.05 109224 1657.7

Step:  AIC=1653.66
IPA_detrended ~ CDD_detrended + petrole_detrended + exportations_detrended + 
    taux_change_detrended + precipitation_detrended

                         Df Sum of Sq    RSS    AIC
&lt;none&gt;                                107628 1653.7
+ importations_detrended  1   141.110 107487 1655.3
+ temperature_detrended   1    44.973 107583 1655.5
+ SMIC_detrended          1     2.829 107625 1655.7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA_detrended ~ CDD_detrended + petrole_detrended + 
    exportations_detrended + taux_change_detrended + precipitation_detrended, 
    data = stationnaire_data)

Coefficients:
            (Intercept)            CDD_detrended        petrole_detrended  
             -1.146e-15                1.636e+00                7.729e-01  
 exportations_detrended    taux_change_detrended  precipitation_detrended  
              2.524e-01                2.129e+01               -1.605e-01  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode descendante</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele1_4,<span class="at">data=</span>stationnaire_data,<span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1659.21
IPA_detrended ~ CDD_detrended + importations_detrended + exportations_detrended + 
    petrole_detrended + taux_change_detrended + SMIC_detrended + 
    precipitation_detrended + temperature_detrended

                          Df Sum of Sq    RSS    AIC
- SMIC_detrended           1       2.9 107455 1657.2
- temperature_detrended    1      33.1 107485 1657.3
- importations_detrended   1     127.7 107579 1657.5
&lt;none&gt;                                 107452 1659.2
- CDD_detrended            1    1260.0 108712 1660.4
- precipitation_detrended  1    1467.0 108919 1660.9
- taux_change_detrended    1    1698.7 109150 1661.5
- exportations_detrended   1    3320.8 110772 1665.6
- petrole_detrended        1    5198.2 112650 1670.2

Step:  AIC=1657.21
IPA_detrended ~ CDD_detrended + importations_detrended + exportations_detrended + 
    petrole_detrended + taux_change_detrended + precipitation_detrended + 
    temperature_detrended

                          Df Sum of Sq    RSS    AIC
- temperature_detrended    1      32.4 107487 1655.3
- importations_detrended   1     128.5 107583 1655.5
&lt;none&gt;                                 107455 1657.2
- CDD_detrended            1    1259.7 108714 1658.4
- precipitation_detrended  1    1464.1 108919 1658.9
- taux_change_detrended    1    1741.0 109196 1659.6
- exportations_detrended   1    3342.6 110797 1663.6
- petrole_detrended        1    5202.0 112657 1668.2

Step:  AIC=1655.3
IPA_detrended ~ CDD_detrended + importations_detrended + exportations_detrended + 
    petrole_detrended + taux_change_detrended + precipitation_detrended

                          Df Sum of Sq    RSS    AIC
- importations_detrended   1     141.1 107628 1653.7
&lt;none&gt;                                 107487 1655.3
- CDD_detrended            1    1237.9 108725 1656.5
- precipitation_detrended  1    1511.4 108998 1657.1
- taux_change_detrended    1    1743.6 109231 1657.7
- exportations_detrended   1    3471.1 110958 1662.0
- petrole_detrended        1    5289.5 112777 1666.5

Step:  AIC=1653.66
IPA_detrended ~ CDD_detrended + exportations_detrended + petrole_detrended + 
    taux_change_detrended + precipitation_detrended

                          Df Sum of Sq    RSS    AIC
&lt;none&gt;                                 107628 1653.7
- CDD_detrended            1    1193.2 108821 1654.7
- precipitation_detrended  1    1596.0 109224 1655.7
- taux_change_detrended    1    1734.3 109362 1656.0
- exportations_detrended   1    3589.6 111218 1660.7
- petrole_detrended        1    5419.0 113047 1665.2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA_detrended ~ CDD_detrended + exportations_detrended + 
    petrole_detrended + taux_change_detrended + precipitation_detrended, 
    data = stationnaire_data)

Coefficients:
            (Intercept)            CDD_detrended   exportations_detrended  
             -1.146e-15                1.636e+00                2.524e-01  
      petrole_detrended    taux_change_detrended  precipitation_detrended  
              7.729e-01                2.129e+01               -1.605e-01  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode double</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="co">#méthode dans les 2 sens</span></span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele0_4,<span class="at">scope=</span><span class="fu">list</span>(<span class="at">upper=</span>modele1_4),<span class="at">data=</span>stationnaire_data,<span class="at">direction=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1677.97
IPA_detrended ~ 1

                          Df Sum of Sq    RSS    AIC
+ CDD_detrended            1    4317.9 117613 1670.0
+ precipitation_detrended  1    4045.9 117885 1670.7
+ petrole_detrended        1    3518.3 118412 1671.9
+ exportations_detrended   1    2899.2 119031 1673.3
&lt;none&gt;                                 121931 1678.0
+ importations_detrended   1     433.1 121497 1679.0
+ temperature_detrended    1     225.7 121705 1679.5
+ taux_change_detrended    1     207.7 121723 1679.5
+ SMIC_detrended           1       9.6 121921 1680.0

Step:  AIC=1670.05
IPA_detrended ~ CDD_detrended

                          Df Sum of Sq    RSS    AIC
+ petrole_detrended        1    3471.6 114141 1663.8
+ exportations_detrended   1    3054.7 114558 1664.8
+ precipitation_detrended  1    1049.9 116563 1669.6
&lt;none&gt;                                 117613 1670.0
+ importations_detrended   1     483.1 117130 1670.9
+ taux_change_detrended    1     319.6 117293 1671.3
+ SMIC_detrended           1      39.6 117573 1672.0
+ temperature_detrended    1      31.3 117581 1672.0
- CDD_detrended            1    4317.9 121931 1678.0

Step:  AIC=1663.82
IPA_detrended ~ CDD_detrended + petrole_detrended

                          Df Sum of Sq    RSS    AIC
+ exportations_detrended   1    3241.0 110900 1657.9
+ precipitation_detrended  1    1445.8 112695 1662.3
+ taux_change_detrended    1    1428.6 112712 1662.3
&lt;none&gt;                                 114141 1663.8
+ importations_detrended   1     343.1 113798 1665.0
+ SMIC_detrended           1      61.4 114080 1665.7
+ temperature_detrended    1       0.3 114141 1665.8
- petrole_detrended        1    3471.6 117613 1670.0
- CDD_detrended            1    4271.3 118412 1671.9

Step:  AIC=1657.89
IPA_detrended ~ CDD_detrended + petrole_detrended + exportations_detrended

                          Df Sum of Sq    RSS    AIC
+ taux_change_detrended    1    1675.9 109224 1655.7
+ precipitation_detrended  1    1537.5 109362 1656.0
&lt;none&gt;                                 110900 1657.9
+ importations_detrended   1     212.5 110688 1659.4
+ temperature_detrended    1      59.2 110841 1659.8
+ SMIC_detrended           1      26.6 110873 1659.8
- exportations_detrended   1    3241.0 114141 1663.8
- petrole_detrended        1    3658.0 114558 1664.8
- CDD_detrended            1    4429.5 115330 1666.7

Step:  AIC=1655.71
IPA_detrended ~ CDD_detrended + petrole_detrended + exportations_detrended + 
    taux_change_detrended

                          Df Sum of Sq    RSS    AIC
+ precipitation_detrended  1    1596.0 107628 1653.7
&lt;none&gt;                                 109224 1655.7
+ importations_detrended   1     225.7 108998 1657.1
+ temperature_detrended    1      66.0 109158 1657.5
+ SMIC_detrended           1       0.0 109224 1657.7
- taux_change_detrended    1    1675.9 110900 1657.9
- exportations_detrended   1    3488.4 112712 1662.3
- CDD_detrended            1    4716.8 113941 1665.3
- petrole_detrended        1    4923.0 114147 1665.8

Step:  AIC=1653.66
IPA_detrended ~ CDD_detrended + petrole_detrended + exportations_detrended + 
    taux_change_detrended + precipitation_detrended

                          Df Sum of Sq    RSS    AIC
&lt;none&gt;                                 107628 1653.7
- CDD_detrended            1    1193.2 108821 1654.7
+ importations_detrended   1     141.1 107487 1655.3
+ temperature_detrended    1      45.0 107583 1655.5
+ SMIC_detrended           1       2.8 107625 1655.7
- precipitation_detrended  1    1596.0 109224 1655.7
- taux_change_detrended    1    1734.3 109362 1656.0
- exportations_detrended   1    3589.6 111218 1660.7
- petrole_detrended        1    5419.0 113047 1665.2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA_detrended ~ CDD_detrended + petrole_detrended + 
    exportations_detrended + taux_change_detrended + precipitation_detrended, 
    data = stationnaire_data)

Coefficients:
            (Intercept)            CDD_detrended        petrole_detrended  
             -1.146e-15                1.636e+00                7.729e-01  
 exportations_detrended    taux_change_detrended  precipitation_detrended  
              2.524e-01                2.129e+01               -1.605e-01  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. MCO modele retenue</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>lm_model4<span class="ot">&lt;-</span>  <span class="fu">lm</span>(<span class="at">formula =</span> IPA_detrended <span class="sc">~</span> CDD_detrended <span class="sc">+</span> petrole_detrended <span class="sc">+</span> </span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>    exportations_detrended <span class="sc">+</span> taux_change_detrended <span class="sc">+</span> precipitation_detrended, </span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> stationnaire_data)</span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA_detrended ~ CDD_detrended + petrole_detrended + 
    exportations_detrended + taux_change_detrended + precipitation_detrended, 
    data = stationnaire_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-61.876  -9.716  -1.679   7.230 114.837 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             -1.146e-15  1.206e+00   0.000 1.000000    
CDD_detrended            1.636e+00  9.472e-01   1.727 0.085330 .  
petrole_detrended        7.729e-01  2.100e-01   3.680 0.000282 ***
exportations_detrended   2.524e-01  8.427e-02   2.995 0.002998 ** 
taux_change_detrended    2.129e+01  1.022e+01   2.082 0.038288 *  
precipitation_detrended -1.605e-01  8.034e-02  -1.997 0.046809 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 20 on 269 degrees of freedom
Multiple R-squared:  0.1173,    Adjusted R-squared:  0.1009 
F-statistic: 7.149 on 5 and 269 DF,  p-value: 2.673e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Hypotheses</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="do">#### Test de normalité des résidus</span></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Résidus</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>residus4 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm_model4)</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residus4, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residus4), <span class="at">sd =</span> <span class="fu">sd</span>(residus4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residus4
D = 0.10967, p-value = 0.002679
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Breusch-Pagan pour l'hétéroscédasticité</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(lm_model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  lm_model4
BP = 8.9646, df = 5, p-value = 0.1105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test RESET</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">reset</span>(lm_model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  lm_model4
RESET = 0.58521, df1 = 2, df2 = 267, p-value = 0.5577</code></pre>
</div>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### multicollinéarité</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lm_model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          CDD_detrended       petrole_detrended  exportations_detrended 
               1.461501                1.116101                1.004650 
  taux_change_detrended precipitation_detrended 
               1.110756                1.468620 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Autocorrelation de résidus</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(lm_model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 109.32, df = 10, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="modèle-5-avec-lag" class="level2">
<h2 class="anchored" data-anchor-id="modèle-5-avec-lag">5. Modèle 5 avec lag</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création du lag </span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>st3_data<span class="sc">$</span>IPA_lag1 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lag</span>(st3_data<span class="sc">$</span>IPA, <span class="dv">1</span>) </span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>st3_data<span class="sc">$</span>IPA_lag2 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lag</span>(st3_data<span class="sc">$</span>IPA, <span class="dv">2</span>) </span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>st3_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(st3_data)</span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle de régression avec Lag 1 , toutes les variables</span></span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>modele1_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA <span class="sc">~</span> CDD <span class="sc">+</span>  importations <span class="sc">+</span> exportations <span class="sc">+</span>  petrole <span class="sc">+</span>  taux_change <span class="sc">+</span> SMIC <span class="sc">+</span> precipitation <span class="sc">+</span> temperature<span class="sc">+</span> IPA_lag1 <span class="sc">+</span> IPA_lag2, <span class="at">data =</span> st3_data)</span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele1_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(modele1_5): essentially perfect fit: summary may be
unreliable</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ CDD + importations + exportations + petrole + 
    taux_change + SMIC + precipitation + temperature + IPA_lag1 + 
    IPA_lag2, data = st3_data)

Residuals:
       Min         1Q     Median         3Q        Max 
-1.009e-16 -7.630e-19  3.920e-19  1.385e-18  8.567e-18 

Coefficients: (1 not defined because of singularities)
                Estimate Std. Error    t value Pr(&gt;|t|)    
(Intercept)   -1.241e-17  6.989e-18 -1.776e+00  0.07685 .  
CDD            1.373e-19  3.110e-19  4.410e-01  0.65935    
importations  -4.797e-21  2.733e-20 -1.760e-01  0.86081    
exportations  -2.301e-20  1.720e-20 -1.338e+00  0.18217    
petrole       -1.954e-19  7.074e-20 -2.762e+00  0.00614 ** 
taux_change   -7.414e-18  3.458e-18 -2.144e+00  0.03296 *  
SMIC           7.534e-21  1.744e-20  4.320e-01  0.66615    
precipitation  6.107e-20  2.850e-20  2.143e+00  0.03303 *  
temperature    5.892e-19  1.116e-18  5.280e-01  0.59807    
IPA_lag1       1.000e+00  1.869e-17  5.350e+16  &lt; 2e-16 ***
IPA_lag2              NA         NA         NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.559e-18 on 265 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:      1 
F-statistic: 3.581e+32 on 9 and 265 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>modele0_5 <span class="ot">&lt;-</span> (<span class="fu">lm</span>((IPA)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>st3_data))</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele0_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (IPA) ~ 1, data = st3_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.060967 -0.014968 -0.002519  0.011062  0.082152 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.008686   0.001356   6.403 6.58e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02249 on 274 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode ascendante</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele0_5, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>modele0_5, <span class="at">upper=</span>modele1_5), <span class="at">data=</span>st3_data, <span class="at">direction=</span><span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-2085.99
(IPA) ~ 1

                Df Sum of Sq     RSS      AIC
+ IPA_lag1       1  0.138635 0.00000 -21080.7
+ IPA_lag2       1  0.138635 0.00000 -21080.7
+ taux_change    1  0.003557 0.13508  -2091.1
+ precipitation  1  0.003276 0.13536  -2090.6
+ petrole        1  0.002705 0.13593  -2089.4
+ exportations   1  0.001609 0.13703  -2087.2
+ CDD            1  0.001505 0.13713  -2087.0
&lt;none&gt;                       0.13864  -2086.0
+ importations   1  0.000470 0.13817  -2084.9
+ temperature    1  0.000147 0.13849  -2084.3
+ SMIC           1  0.000120 0.13852  -2084.2

Step:  AIC=-21080.67
(IPA) ~ IPA_lag1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attempting model selection on an essentially perfect fit is nonsense</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df  Sum of Sq        RSS    AIC
+ exportations   1 1.8869e-33 1.3657e-31 -21082
+ temperature    1 1.3833e-33 1.3707e-31 -21081
&lt;none&gt;                        1.3845e-31 -21081
+ importations   1 3.9347e-34 1.3806e-31 -21080
+ SMIC           1 8.2170e-35 1.3837e-31 -21079
+ CDD            1 5.1420e-35 1.3840e-31 -21079
+ precipitation  1 2.0090e-35 1.3844e-31 -21079
+ taux_change    1 8.1400e-36 1.3845e-31 -21079
+ petrole        1 2.5000e-36 1.3845e-31 -21079

Step:  AIC=-21082.45
(IPA) ~ IPA_lag1 + exportations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attempting model selection on an essentially perfect fit is nonsense</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df  Sum of Sq        RSS    AIC
&lt;none&gt;                        1.3657e-31 -21082
+ temperature    1 6.9380e-34 1.3587e-31 -21082
+ importations   1 3.5406e-34 1.3621e-31 -21081
+ SMIC           1 5.2300e-35 1.3652e-31 -21081
+ taux_change    1 5.8700e-36 1.3656e-31 -21080
+ precipitation  1 5.5600e-36 1.3656e-31 -21080
+ CDD            1 1.5500e-36 1.3657e-31 -21080
+ petrole        1 5.0000e-37 1.3657e-31 -21080</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (IPA) ~ IPA_lag1 + exportations, data = st3_data)

Coefficients:
 (Intercept)      IPA_lag1  exportations  
  -1.506e-17     1.000e+00     1.072e-19  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode descendante</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele1_5,<span class="at">data=</span>st3_data,<span class="at">direction=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-21751.32
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    SMIC + precipitation + temperature + IPA_lag1 + IPA_lag2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attempting model selection on an essentially perfect fit is nonsense</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Step:  AIC=-21751.32
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    SMIC + precipitation + temperature + IPA_lag1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attempting model selection on an essentially perfect fit is nonsense</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum of Sq     RSS      AIC
- temperature    1   0.00000 0.00000 -22202.5
&lt;none&gt;                       0.00000 -21751.3
- exportations   1   0.00000 0.00000 -21503.4
- SMIC           1   0.00000 0.00000 -21332.8
- taux_change    1   0.00000 0.00000 -21299.5
- precipitation  1   0.00000 0.00000 -21291.9
- importations   1   0.00000 0.00000 -21253.2
- petrole        1   0.00000 0.00000 -21175.4
- CDD            1   0.00000 0.00000 -21087.1
- IPA_lag1       1   0.12312 0.12312  -2102.6

Step:  AIC=-22202.49
IPA ~ CDD + importations + exportations + petrole + taux_change + 
    SMIC + precipitation + IPA_lag1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attempting model selection on an essentially perfect fit is nonsense</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum of Sq     RSS      AIC
&lt;none&gt;                       0.00000 -22202.5
- precipitation  1   0.00000 0.00000 -22111.0
- SMIC           1   0.00000 0.00000 -21726.0
- CDD            1   0.00000 0.00000 -21712.0
- taux_change    1   0.00000 0.00000 -21535.4
- importations   1   0.00000 0.00000 -21210.2
- petrole        1   0.00000 0.00000 -21164.7
- exportations   1   0.00000 0.00000 -20815.4
- IPA_lag1       1   0.12366 0.12366  -2103.4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ CDD + importations + exportations + petrole + 
    taux_change + SMIC + precipitation + IPA_lag1, data = st3_data)

Coefficients:
  (Intercept)            CDD   importations   exportations        petrole  
    5.633e-18      2.800e-20      1.035e-20      1.892e-20      1.212e-19  
  taux_change           SMIC  precipitation       IPA_lag1  
    7.330e-18     -8.519e-21     -2.797e-20      1.000e+00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Méthode double</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="co">#méthode dans les 2 sens</span></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(modele0_5,<span class="at">scope=</span><span class="fu">list</span>(<span class="at">upper=</span>modele1_5),<span class="at">data=</span>st3_data,<span class="at">direction=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-2085.99
(IPA) ~ 1

                Df Sum of Sq     RSS      AIC
+ IPA_lag1       1  0.138635 0.00000 -21080.7
+ IPA_lag2       1  0.138635 0.00000 -21080.7
+ taux_change    1  0.003557 0.13508  -2091.1
+ precipitation  1  0.003276 0.13536  -2090.6
+ petrole        1  0.002705 0.13593  -2089.4
+ exportations   1  0.001609 0.13703  -2087.2
+ CDD            1  0.001505 0.13713  -2087.0
&lt;none&gt;                       0.13864  -2086.0
+ importations   1  0.000470 0.13817  -2084.9
+ temperature    1  0.000147 0.13849  -2084.3
+ SMIC           1  0.000120 0.13852  -2084.2

Step:  AIC=-21080.67
(IPA) ~ IPA_lag1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attempting model selection on an essentially perfect fit is nonsense</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attempting model selection on an essentially perfect fit is nonsense</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum of Sq     RSS    AIC
+ exportations   1   0.00000 0.00000 -21082
+ temperature    1   0.00000 0.00000 -21081
&lt;none&gt;                       0.00000 -21081
+ importations   1   0.00000 0.00000 -21080
+ SMIC           1   0.00000 0.00000 -21079
+ CDD            1   0.00000 0.00000 -21079
+ precipitation  1   0.00000 0.00000 -21079
+ taux_change    1   0.00000 0.00000 -21079
+ petrole        1   0.00000 0.00000 -21079
- IPA_lag1       1   0.13864 0.13864  -2086

Step:  AIC=-21082.45
(IPA) ~ IPA_lag1 + exportations</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attempting model selection on an essentially perfect fit is nonsense
Warning: attempting model selection on an essentially perfect fit is nonsense</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum of Sq     RSS      AIC
&lt;none&gt;                       0.00000 -21082.4
+ temperature    1   0.00000 0.00000 -21081.8
+ importations   1   0.00000 0.00000 -21081.2
- exportations   1   0.00000 0.00000 -21080.7
+ SMIC           1   0.00000 0.00000 -21080.6
+ taux_change    1   0.00000 0.00000 -21080.5
+ precipitation  1   0.00000 0.00000 -21080.5
+ CDD            1   0.00000 0.00000 -21080.4
+ petrole        1   0.00000 0.00000 -21080.4
- IPA_lag1       1   0.13703 0.13703  -2087.2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (IPA) ~ IPA_lag1 + exportations, data = st3_data)

Coefficients:
 (Intercept)      IPA_lag1  exportations  
  -1.506e-17     1.000e+00     1.072e-19  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># modele 7 </span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> (IPA) <span class="sc">~</span> IPA_lag1 <span class="sc">+</span> taux_change <span class="sc">+</span> petrole <span class="sc">+</span> precipitation,   <span class="at">data =</span> st3_data)</span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(model5): essentially perfect fit: summary may be
unreliable</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = (IPA) ~ IPA_lag1 + taux_change + petrole + precipitation, 
    data = st3_data)

Residuals:
       Min         1Q     Median         3Q        Max 
-3.690e-16  5.900e-19  1.390e-18  2.150e-18  2.202e-17 

Coefficients:
                Estimate Std. Error    t value Pr(&gt;|t|)    
(Intercept)   -8.369e-18  1.130e-17 -7.410e-01    0.460    
IPA_lag1       1.000e+00  6.392e-17  1.564e+16   &lt;2e-16 ***
taux_change    1.465e-18  1.183e-17  1.240e-01    0.902    
petrole       -1.174e-21  2.431e-19 -5.000e-03    0.996    
precipitation -1.530e-20  7.617e-20 -2.010e-01    0.841    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.264e-17 on 270 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:      1 
F-statistic: 6.76e+31 on 4 and 270 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="do">## TESTS </span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>residus7 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model5)</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residus7, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residus7), <span class="at">sd =</span> <span class="fu">sd</span>(residus7))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residus7
D = 0.41462, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  model5
BP = 1.407, df = 4, p-value = 0.843</code></pre>
</div>
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reset</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  model5
RESET = 34.971, df1 = 2, df2 = 268, p-value = 3.2e-14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summary.lm(object, ...): essentially perfect fit: summary may be
unreliable</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     IPA_lag1   taux_change       petrole precipitation 
     1.104992      1.165378      1.167885      1.040446 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(model5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Breusch-Godfrey test for serial correlation of order up to 10

data:  Residuals
LM test = 1.1638, df = 10, p-value = 0.9997</code></pre>
</div>
</div>
<ul>
<li><p>La présence d’hétéroscédasticité signifie que la variance des résidus n’est pas constante. Cela peut affecter la validité des tests de significativité des coefficients.</p></li>
<li><p>Le test RESET suggère que le modèle pourrait être mal spécifié, indiquant que la relation entre les variables n’est pas correctement capturée par le modèle linéaire.</p></li>
<li><p>On ne peut donc pas utiliser la méthode des MCO pour estimer le modèle : les coefficients MCO ne sont pas biaisés mais la variance de l’estimateur est non minimale</p></li>
</ul>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Tous les modèles estimés avec les MCO présentent de l’autocorrelation de résidus, c’est à dire une corrélation entre les résidus eux-mêmes à travers le temps.</p>
<p>Introduire des lags peut régler le problème mais cela a généré un surajustement et aussi de l’heteroscedasticité et la forme linéaire n’est pas accepte</p>
</section>
<section id="armax" class="level1">
<h1>ARMAX</h1>
<p>Modèle 0 de test avec ARMAX avec toutes les variables et sans stationnaire</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> ts_data[,<span class="dv">1</span>]</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>vars0 <span class="ot">&lt;-</span> ts_data[,<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation du modèle ARMAX</span></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a>armax_model0 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(y0, <span class="at">xreg =</span> vars0, <span class="at">stationary=</span><span class="cn">FALSE</span>, <span class="at">seasonal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle ARMAX</span></span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(armax_model0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y0 
Regression with ARIMA(0,0,2)(0,0,2)[12] errors 

Coefficients:
         ma1     ma2    sma1    sma2  intercept      CDD  importations
      1.7037  0.9516  0.9901  0.7025   259.7776  -2.4083       -0.0915
s.e.  0.0284  0.0267  0.0567  0.0744    73.3117   0.8277        0.0951
      exportations  petrole  taux_change     SMIC  precipitation  temperature
            0.1874   2.2594     164.8233  -0.2381        -0.1904      -4.4766
s.e.        0.1554   0.3452      17.1950   0.1022         0.0555       2.7707

sigma^2 = 3774:  log likelihood = -1533.74
AIC=3095.47   AICc=3097.08   BIC=3146.16

Training set error measures:
                   ME     RMSE      MAE       MPE    MAPE      MASE      ACF1
Training set 1.907931 59.96586 44.41014 -3.310016 7.32571 0.4048599 0.4175662</code></pre>
</div>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(armax_model0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

                Estimate Std. Error z value  Pr(&gt;|z|)    
ma1             1.703724   0.028368 60.0583 &lt; 2.2e-16 ***
ma2             0.951628   0.026672 35.6791 &lt; 2.2e-16 ***
sma1            0.990059   0.056723 17.4542 &lt; 2.2e-16 ***
sma2            0.702488   0.074445  9.4364 &lt; 2.2e-16 ***
intercept     259.777581  73.311667  3.5435 0.0003949 ***
CDD            -2.408346   0.827653 -2.9098 0.0036160 ** 
importations   -0.091498   0.095088 -0.9622 0.3359263    
exportations    0.187358   0.155367  1.2059 0.2278520    
petrole         2.259368   0.345224  6.5446 5.964e-11 ***
taux_change   164.823254  17.194956  9.5856 &lt; 2.2e-16 ***
SMIC           -0.238088   0.102210 -2.3294 0.0198384 *  
precipitation  -0.190378   0.055512 -3.4295 0.0006048 ***
temperature    -4.476600   2.770688 -1.6157 0.1061593    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test hypotheses </span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Résidus du modèle ARMAX</span></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>residuals_armax0 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(armax_model0)</span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residuals_armax0, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residuals_armax0), <span class="at">sd =</span> <span class="fu">sd</span>(residuals_armax0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residuals_armax0
D = 0.091781, p-value = 0.01913
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Ljung-Box pour l'autocorrélation des résidus</span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(armax_model0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,0,2)(0,0,2)[12] errors
Q* = 1002.1, df = 20, p-value &lt; 2.2e-16

Model df: 4.   Total lags used: 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Breusch-Pagan pour l'hétéroscédasticité</span></span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(residuals_armax0 <span class="sc">~</span> vars0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  residuals_armax0 ~ vars0
BP = 40.396, df = 8, p-value = 2.703e-06</code></pre>
</div>
</div>
<p>Problème d’autocorrelation Ljung-Box test p-value &lt; 2.2e-16</p>
<p>Problème d’homoscedasticité Breusch-Pagan p-value test 2.703e-06</p>
<p>Problème normalité Kolmogorov-Smirnov test p-value = 0.01913</p>
<section id="test-modèle-armax-avec-toutes-les-variables-stationnaires" class="level2">
<h2 class="anchored" data-anchor-id="test-modèle-armax-avec-toutes-les-variables-stationnaires">1. Test Modèle ARMAX avec toutes les variables stationnaires</h2>
<p>Inclut toutes les variables (stationnaires)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des séries temporelles pour ARMAX</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(stationnaire_data[,<span class="dv">2</span>], <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>vars1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stationnaire_data[, <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>]) </span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation du modèle ARMAX avec toutes les variables</span></span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a>armax_model1 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(y1, <span class="at">xreg =</span> vars1, <span class="at">stationary=</span><span class="cn">TRUE</span>)</span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle ARMAX</span></span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(armax_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y1 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1     CDD  importations  exportations  petrole  taux_change     SMIC
      0.6287  1.1559        0.0637        0.1804   0.4564      17.5248  -0.0450
s.e.  0.0481  0.6013        0.0484        0.0761   0.1631       7.6201   0.0614
      precipitation  temperature
            -0.0359      -2.1677
s.e.         0.0467       2.7029

sigma^2 = 252.9:  log likelihood = -1146.68
AIC=2313.35   AICc=2314.19   BIC=2349.52

Training set error measures:
                    ME     RMSE      MAE       MPE     MAPE      MASE
Training set 0.0270672 15.64079 10.78681 -29.08853 267.4824 0.5550402
                    ACF1
Training set 0.007601316</code></pre>
</div>
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(armax_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

               Estimate Std. Error z value  Pr(&gt;|z|)    
ar1            0.628669   0.048053 13.0827 &lt; 2.2e-16 ***
CDD            1.155934   0.601305  1.9224  0.054558 .  
importations   0.063678   0.048399  1.3157  0.188280    
exportations   0.180353   0.076142  2.3686  0.017854 *  
petrole        0.456407   0.163119  2.7980  0.005142 ** 
taux_change   17.524841   7.620106  2.2998  0.021459 *  
SMIC          -0.045022   0.061439 -0.7328  0.463685    
precipitation -0.035863   0.046699 -0.7680  0.442514    
temperature   -2.167712   2.702941 -0.8020  0.422563    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test hypotheses </span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Résidus du modèle ARMAX</span></span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Ljung-Box pour l'autocorrélation des résidus</span></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(armax_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(1,0,0) errors
Q* = 29.046, df = 23, p-value = 0.1788

Model df: 1.   Total lags used: 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a>residuals_armax1 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(armax_model1)</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residuals_armax1, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residuals_armax1), <span class="at">sd =</span> <span class="fu">sd</span>(residuals_armax1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residuals_armax1
D = 0.10094, p-value = 0.007368
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Breusch-Pagan pour l'hétéroscédasticité</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(residuals_armax1 <span class="sc">~</span> vars1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  residuals_armax1 ~ vars1
BP = 43.638, df = 8, p-value = 6.66e-07</code></pre>
</div>
</div>
</section>
<section id="armax-avec-variables-sélectionnes-par-stepwise-et-best-sub" class="level2">
<h2 class="anchored" data-anchor-id="armax-avec-variables-sélectionnes-par-stepwise-et-best-sub">2. ARMAX Avec variables sélectionnes par stepwise et best sub</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(stationnaire_data[,<span class="dv">2</span>], <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>vars2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stationnaire_data[, <span class="fu">c</span>(<span class="st">"exportations"</span>, <span class="st">"petrole"</span>, <span class="st">"precipitation"</span>, <span class="st">"taux_change"</span>, <span class="st">"CDD"</span>)])</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation du modèle ARMAX</span></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a>armax_model2 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(y2, <span class="at">xreg =</span> vars2, <span class="at">stationary=</span><span class="cn">TRUE</span>)</span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle ARMAX</span></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(armax_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y2 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1  exportations  petrole  precipitation  taux_change     CDD
      0.6213        0.1782   0.4950        -0.0589      17.5920  0.6530
s.e.  0.0483        0.0743   0.1629         0.0335       7.6554  0.4628

sigma^2 = 253.1:  log likelihood = -1148.31
AIC=2310.62   AICc=2311.04   BIC=2335.94

Training set error measures:
                      ME     RMSE      MAE       MPE     MAPE     MASE
Training set -0.08807324 15.73433 10.71464 -49.22505 311.8129 0.551327
                   ACF1
Training set 0.00296305</code></pre>
</div>
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(armax_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

               Estimate Std. Error z value  Pr(&gt;|z|)    
ar1            0.621273   0.048281 12.8680 &lt; 2.2e-16 ***
exportations   0.178229   0.074289  2.3991  0.016434 *  
petrole        0.495043   0.162892  3.0391  0.002373 ** 
precipitation -0.058927   0.033472 -1.7605  0.078325 .  
taux_change   17.591999   7.655369  2.2980  0.021562 *  
CDD            0.653047   0.462793  1.4111  0.158215    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test hypothèses </span></span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Résidus du modèle ARMAX</span></span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a>residuals_armax2 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(armax_model2)</span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Ljung-Box pour l'autocorrélation des résidus</span></span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(armax_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(1,0,0) errors
Q* = 29.109, df = 23, p-value = 0.1767

Model df: 1.   Total lags used: 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residuals_armax2, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residuals_armax2), <span class="at">sd =</span> <span class="fu">sd</span>(residuals_armax2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residuals_armax2
D = 0.094687, p-value = 0.01444
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Breusch-Pagan pour l'hétéroscédasticité</span></span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(residuals_armax2 <span class="sc">~</span> vars2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  residuals_armax2 ~ vars2
BP = 40.625, df = 5, p-value = 1.117e-07</code></pre>
</div>
</div>
</section>
<section id="modèle-armax-st2_data-utilise-le-diff_log_ipa" class="level2">
<h2 class="anchored" data-anchor-id="modèle-armax-st2_data-utilise-le-diff_log_ipa">3. Modèle ARMAX (st2_data utilise le diff_log_IPA)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(st2_data[,<span class="dv">2</span>], <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a>vars3 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stationnaire_data[, <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>]) </span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation du modèle ARMAX</span></span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a>armax_model3 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(y3, <span class="at">xreg =</span> vars3, <span class="at">stationary=</span><span class="cn">TRUE</span>)</span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle ARMAX</span></span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(armax_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y3 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1    CDD  importations  exportations  petrole  taux_change   SMIC
      0.5779  1e-03         1e-04         1e-04    5e-04       0.0235  0e+00
s.e.  0.0497  7e-04         1e-04         1e-04    2e-04       0.0087  1e-04
      precipitation  temperature
              0e+00      -0.0022
s.e.          1e-04       0.0031

sigma^2 = 0.000318:  log likelihood = 721.5
AIC=-1423.01   AICc=-1422.18   BIC=-1386.84

Training set error measures:
                       ME       RMSE        MAE      MPE     MAPE      MASE
Training set 0.0001684718 0.01753895 0.01381429 25.05035 248.0198 0.5412742
                   ACF1
Training set 0.03623777</code></pre>
</div>
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(armax_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

                 Estimate  Std. Error z value Pr(&gt;|z|)    
ar1            5.7793e-01  4.9748e-02 11.6172  &lt; 2e-16 ***
CDD            9.8542e-04  6.8656e-04  1.4353  0.15120    
importations   8.0666e-05  8.2173e-05  0.9817  0.32627    
exportations   1.2371e-04  1.0106e-04  1.2241  0.22090    
petrole        4.6616e-04  1.9498e-04  2.3908  0.01681 *  
taux_change    2.3475e-02  8.7243e-03  2.6907  0.00713 ** 
SMIC           1.4973e-06  9.4345e-05  0.0159  0.98734    
precipitation -4.1973e-05  7.6820e-05 -0.5464  0.58480    
temperature   -2.2270e-03  3.0740e-03 -0.7244  0.46879    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test hypotheses </span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Résidus du modèle ARMAX</span></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a>residuals_armax3 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(armax_model3)</span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Ljung-Box pour l'autocorrélation des résidus</span></span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(residuals_armax3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals
Q* = 14.905, df = 24, p-value = 0.9235

Model df: 0.   Total lags used: 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residuals_armax3, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residuals_armax3), <span class="at">sd =</span> <span class="fu">sd</span>(residuals_armax3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residuals_armax3
D = 0.045432, p-value = 0.6214
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Breusch-Pagan pour l'hétéroscédasticité</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(residuals_armax3 <span class="sc">~</span> vars3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  residuals_armax3 ~ vars3
BP = 12.266, df = 8, p-value = 0.1397</code></pre>
</div>
</div>
</section>
<section id="modèle-armax2---variables-sélectionnés-st2_data-utilise-le-diff_log_ipa" class="level2">
<h2 class="anchored" data-anchor-id="modèle-armax2---variables-sélectionnés-st2_data-utilise-le-diff_log_ipa">4. Modèle ARMAX2 - Variables sélectionnés (st2_data utilise le diff_log_IPA)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">ts</span>(st2_data[,<span class="dv">2</span>], <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a>vars4 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(stationnaire_data[, <span class="fu">c</span>(<span class="st">"exportations"</span>, <span class="st">"petrole"</span>, <span class="st">"precipitation"</span>, <span class="st">"taux_change"</span>)])</span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation du modèle ARMAX</span></span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a>armax_model4 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(y4, <span class="at">xreg =</span> vars4, <span class="at">stationary=</span><span class="cn">TRUE</span>, <span class="at">seasonal =</span> <span class="cn">FALSE</span>, <span class="at">stepwise=</span><span class="cn">FALSE</span>, <span class="at">approximation=</span><span class="cn">FALSE</span>)</span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du modèle ARMAX</span></span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(armax_model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: y4 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1  intercept  exportations  petrole  precipitation  taux_change
      0.5706     0.0146         1e-04    5e-04         -1e-04       0.0238
s.e.  0.0501     0.0108         1e-04    2e-04          1e-04       0.0088

sigma^2 = 0.0003175:  log likelihood = 720.18
AIC=-1426.35   AICc=-1425.94   BIC=-1401.04

Training set error measures:
                       ME       RMSE        MAE      MPE     MAPE      MASE
Training set 4.259534e-05 0.01762421 0.01372311 13.16189 288.5038 0.5377013
                   ACF1
Training set 0.03113072</code></pre>
</div>
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(armax_model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

                 Estimate  Std. Error z value  Pr(&gt;|z|)    
ar1            5.7057e-01  5.0115e-02 11.3853 &lt; 2.2e-16 ***
intercept      1.4609e-02  1.0759e-02  1.3578  0.174539    
exportations   1.2270e-04  1.0064e-04  1.2193  0.222748    
petrole        5.1753e-04  1.9494e-04  2.6549  0.007934 ** 
precipitation -8.6525e-05  7.1846e-05 -1.2043  0.228467    
taux_change    2.3816e-02  8.7529e-03  2.7209  0.006510 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test hypotheses </span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Résidus du modèle ARMAX</span></span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>residuals_armax <span class="ot">&lt;-</span> <span class="fu">residuals</span>(armax_model4)</span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de normalité des résidus</span></span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residuals_armax, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residuals_armax), <span class="at">sd =</span> <span class="fu">sd</span>(residuals_armax))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residuals_armax
D = 0.059652, p-value = 0.2818
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Ljung-Box pour l'autocorrélation des résidus</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(armax_model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(1,0,0) errors
Q* = 14.994, df = 23, p-value = 0.8948

Model df: 1.   Total lags used: 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Breusch-Pagan pour l'hétéroscédasticité</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(residuals_armax <span class="sc">~</span> vars4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  residuals_armax ~ vars4
BP = 4.8771, df = 4, p-value = 0.3001</code></pre>
</div>
</div>
<ul>
<li><p>Test de Kolmogorov-Smirnov Une p-value de 0.4388 indique qu’il n’y a pas de preuve statistique pour rejeter l’hypothèse nulle selon laquelle les résidus suivent une distribution normale. Cela signifie que les résidus peuvent être considérés comme normalement distribués</p></li>
<li><p>Test de Ljung-Box (Box-Ljung Test) Une p-value de 0.593 indique que on ne rejete pas l’hypothèse nulle d’indépendance des résidus et donc pas d’autocorrélation significative dans les résidus du modèle</p></li>
<li><p>Test de Breusch-Pagan Hypothèse nulle: les variances des résidus sont homogènes, c’est-à-dire qu’il n’y a pas d’hétéroscédasticité dans les résidus de votre modèle. Avec une p-value de 0.3751, on ne rejet pas l’hypothèse nulle car il n’y a pas de preuves statistiquement significatives d’hétéroscédasticité dans les résidus du modèle ARMAX</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># écart pour la bande de prédiction à 80%</span></span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>ec80 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(armax_model4<span class="sc">$</span>sigma2) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.90</span>)</span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeurs ajustées (prédictions)</span></span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a>vajust <span class="ot">&lt;-</span> <span class="fu">fitted</span>(armax_model4)</span>
<span id="cb460-6"><a href="#cb460-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-7"><a href="#cb460-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrice avec les valeurs observées, les valeurs ajustées, et les bandes de prédiction</span></span>
<span id="cb460-8"><a href="#cb460-8" aria-hidden="true" tabindex="-1"></a>matri <span class="ot">&lt;-</span> <span class="fu">as.ts</span>(<span class="fu">cbind</span>(y4, vajust <span class="sc">-</span> ec80, vajust <span class="sc">+</span> ec80), <span class="at">start =</span> <span class="fu">start</span>(y4), <span class="at">frequency =</span> <span class="fu">frequency</span>(y4))</span>
<span id="cb460-9"><a href="#cb460-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-10"><a href="#cb460-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique</span></span>
<span id="cb460-11"><a href="#cb460-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(matri, <span class="at">plot.type =</span> <span class="st">'single'</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">"Temps"</span>, <span class="at">ylab =</span> <span class="st">'Valeur'</span>, <span class="at">main =</span> <span class="st">""</span>, <span class="at">cex.main =</span> <span class="fl">0.8</span>)</span>
<span id="cb460-12"><a href="#cb460-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Valeur observée"</span>, <span class="st">"Bande de prédiction 80%"</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion </span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>indi <span class="ot">&lt;-</span> (y4<span class="sc">-</span>(vajust<span class="sc">-</span>ec80))<span class="sc">&gt;</span><span class="dv">0</span><span class="sc">&amp;</span>(vajust<span class="sc">+</span>ec80<span class="sc">-</span>y4)<span class="sc">&gt;</span><span class="dv">0</span></span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">sum</span>(indi)<span class="sc">/</span><span class="fu">length</span>(indi)</span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true" tabindex="-1"></a>prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80.36364</code></pre>
</div>
</div>
<p>Montre les valeurs observées de notre série temporelle, ainsi que les valeurs ajustées par le modèle ARMAX avec une bande de prédiction à 80%.</p>
<p>La proportion observée vaut 81%, elle est un peu supérieure à la valeur théorique de 80%. On considérera que l’ajustement est satisfaisant.</p>
</section>
</section>
<section id="comparaison-lm-et-armax" class="level1">
<h1>Comparaison lm et armax</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span><span class="fu">arima</span>(y4, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">xreg =</span> vars4)</span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
z test of coefficients:

                 Estimate  Std. Error z value  Pr(&gt;|z|)    
intercept      3.3422e-02  1.0849e-02  3.0808 0.0020648 ** 
exportations   9.0536e-05  7.9817e-05  1.1343 0.2566699    
petrole        8.3814e-04  2.3070e-04  3.6331 0.0002801 ***
precipitation -2.0544e-04  9.2734e-05 -2.2153 0.0267371 *  
taux_change    4.1333e-02  1.0818e-02  3.8209 0.0001330 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a>lm_model2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ taux_change + petrole + precipitation + exportations, 
    data = st2_data)

Coefficients:
  (Intercept)    taux_change        petrole  precipitation   exportations  
    3.342e-02      4.133e-02      8.381e-04     -2.054e-04      9.054e-05  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ taux_change + petrole + precipitation + exportations, 
    data = st2_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.053072 -0.013313 -0.002177  0.009744  0.072178 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    3.342e-02  1.095e-02   3.053 0.002494 ** 
taux_change    4.133e-02  1.092e-02   3.786 0.000189 ***
petrole        8.381e-04  2.247e-04   3.730 0.000234 ***
precipitation -2.054e-04  7.110e-05  -2.889 0.004173 ** 
exportations   9.054e-05  5.277e-05   1.716 0.087389 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02144 on 270 degrees of freedom
Multiple R-squared:  0.1048,    Adjusted R-squared:  0.09151 
F-statistic:   7.9 on 4 and 270 DF,  p-value: 4.911e-06</code></pre>
</div>
</div>
<p>On trouve effectivement les mêmes estimations que par lm() dans lm_model2; cependant on note des différences dans les écarts types des estimateurs. Ceci peut s’expliquer par le fait que Arima() fournit une estimation de la matrice des covariances des estimateurs à partir du Hessien de la log-vraisemblance, estimation peu précise.</p>
<section id="acf---pacf" class="level2">
<h2 class="anchored" data-anchor-id="acf---pacf">ACF - PACF</h2>
<p>On reprend le modèle avec diff log, les variables sélectionnés et</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(lm_model2),<span class="at">lag.max=</span><span class="dv">30</span>,<span class="at">numer=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "numer" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "numer" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in axis(side = side, at = at, labels = labels, ...): "numer" is not a
graphical parameter
Warning in axis(side = side, at = at, labels = labels, ...): "numer" is not a
graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in box(...): "numer" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "numer" is not a graphical parameter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">residuals</span>(lm_model2),<span class="at">lag.max=</span><span class="dv">30</span>,<span class="at">numer=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.window(...): "numer" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy, type, ...): "numer" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in axis(side = side, at = at, labels = labels, ...): "numer" is not a
graphical parameter
Warning in axis(side = side, at = at, labels = labels, ...): "numer" is not a
graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in box(...): "numer" is not a graphical parameter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in title(...): "numer" is not a graphical parameter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="modèle-mix---mcg---ar" class="level1">
<h1>Modèle mix - MCG - AR</h1>
<p>on rajoute un terme AR 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a>gls_model1 <span class="ot">&lt;-</span> <span class="fu">gls</span>(IPA <span class="sc">~</span> taux_change <span class="sc">+</span> petrole <span class="sc">+</span> precipitation <span class="sc">+</span> exportations, </span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> st2_data,  <span class="fu">corAR1</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gls_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized least squares fit by REML
  Model: IPA ~ taux_change + petrole + precipitation + exportations 
  Data: st2_data 
        AIC       BIC   logLik
  -1358.525 -1333.336 686.2625

Correlation Structure: AR(1)
 Formula: ~1 
 Parameter estimate(s):
      Phi 
0.5772593 

Coefficients:
                     Value   Std.Error   t-value p-value
(Intercept)    0.014436953 0.009895293  1.458972  0.1457
taux_change    0.023704728 0.008770127  2.702895  0.0073
petrole        0.000515314 0.000186171  2.767966  0.0060
precipitation -0.000085580 0.000059949 -1.427533  0.1546
exportations   0.000123323 0.000080308  1.535635  0.1258

 Correlation: 
              (Intr) tx_chn petrol prcptt
taux_change    0.003                     
petrole        0.057  0.161              
precipitation -0.875 -0.047 -0.078       
exportations  -0.390  0.066  0.019 -0.023

Standardized residuals:
       Min         Q1        Med         Q3        Max 
-2.4484944 -0.6036554 -0.0997161  0.4664663  3.3688730 

Residual standard error: 0.02178264 
Degrees of freedom: 275 total; 270 residual</code></pre>
</div>
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification des résidus</span></span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a>residuals_gls_model <span class="ot">&lt;-</span> <span class="fu">residuals</span>(gls_model1)</span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb483-4"><a href="#cb483-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(residuals_gls_model, <span class="at">main =</span> <span class="st">"ACF des résidus du modèle AR(1)"</span>)</span>
<span id="cb483-5"><a href="#cb483-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(residuals_gls_model, <span class="at">main =</span> <span class="st">"PACF des résidus du modèle AR(1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(gls_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-60-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from REML
Q* = 144.13, df = 24, p-value &lt; 2.2e-16

Model df: 0.   Total lags used: 24</code></pre>
</div>
</div>
<p>gls : La fonction gls permet de spécifier des modèles de régression avec des structures de corrélation spécifiques pour les erreurs. corARMA(p = 1, form = ~ 1) : Cet argument spécifie que les résidus du modèle doivent suivre un processus AR(1).</p>
<section id="modèle-mco-avec-les-résidus-ajustés-avec-un-modèle-ar1" class="level2">
<h2 class="anchored" data-anchor-id="modèle-mco-avec-les-résidus-ajustés-avec-un-modèle-ar1">Modèle MCO avec les résidus ajustés avec un modèle AR(1)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb486"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># On ajuste le modèle avec base st2 (qui utilise diff_log_IPA) pour obtenir les résidus</span></span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a>lm_base <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA <span class="sc">~</span> taux_change <span class="sc">+</span> petrole <span class="sc">+</span> precipitation <span class="sc">+</span> exportations, <span class="at">data =</span> st2_data)</span>
<span id="cb486-3"><a href="#cb486-3" aria-hidden="true" tabindex="-1"></a>residuals_base <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm_base)</span>
<span id="cb486-4"><a href="#cb486-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-5"><a href="#cb486-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  modèle AR(1) sur les résidus</span></span>
<span id="cb486-6"><a href="#cb486-6" aria-hidden="true" tabindex="-1"></a>ar1_residuals <span class="ot">&lt;-</span> <span class="fu">arima</span>(residuals_base, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb486-7"><a href="#cb486-7" aria-hidden="true" tabindex="-1"></a>ar1_fitted <span class="ot">&lt;-</span> <span class="fu">fitted</span>(ar1_residuals)</span>
<span id="cb486-8"><a href="#cb486-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-9"><a href="#cb486-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  les valeurs ajustées de l'AR(1) comme une nouvelle variable</span></span>
<span id="cb486-10"><a href="#cb486-10" aria-hidden="true" tabindex="-1"></a>st2_data<span class="sc">$</span>ar1_fitted <span class="ot">&lt;-</span> ar1_fitted</span>
<span id="cb486-11"><a href="#cb486-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-12"><a href="#cb486-12" aria-hidden="true" tabindex="-1"></a><span class="co"># On reajuste le modèle linéaire en incluant la nouvelle variable</span></span>
<span id="cb486-13"><a href="#cb486-13" aria-hidden="true" tabindex="-1"></a>lm_corrected <span class="ot">&lt;-</span> <span class="fu">lm</span>(IPA <span class="sc">~</span> taux_change <span class="sc">+</span> petrole <span class="sc">+</span> precipitation <span class="sc">+</span> exportations <span class="sc">+</span> ar1_fitted, <span class="at">data =</span> st2_data)</span>
<span id="cb486-14"><a href="#cb486-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb486-15"><a href="#cb486-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Résumé du nouveau modèle</span></span>
<span id="cb486-16"><a href="#cb486-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_corrected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = IPA ~ taux_change + petrole + precipitation + exportations + 
    ar1_fitted, data = st2_data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.048087 -0.011929 -0.001883  0.012298  0.046143 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    2.689e-02  9.236e-03   2.912  0.00390 ** 
taux_change    3.888e-02  9.192e-03   4.229 3.22e-05 ***
petrole        5.884e-04  1.906e-04   3.087  0.00224 ** 
precipitation -1.603e-04  6.000e-05  -2.671  0.00802 ** 
exportations   9.157e-05  4.442e-05   2.062  0.04020 *  
ar1_fitted     1.022e+00  9.654e-02  10.589  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01805 on 269 degrees of freedom
Multiple R-squared:  0.3681,    Adjusted R-squared:  0.3564 
F-statistic: 31.35 on 5 and 269 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification des résidus du modèle corrigé</span></span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true" tabindex="-1"></a>residuals_corrected <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm_corrected)</span>
<span id="cb488-3"><a href="#cb488-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb488-4"><a href="#cb488-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(residuals_corrected, <span class="at">main =</span> <span class="st">"ACF des résidus du modèle corrigé"</span>)</span>
<span id="cb488-5"><a href="#cb488-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(residuals_corrected, <span class="at">main =</span> <span class="st">"PACF des résidus du modèle corrigé"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb489"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(residuals_corrected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="memoire_m1_files/figure-html/unnamed-chunk-61-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals
Q* = 6.4074, df = 10, p-value = 0.78

Model df: 0.   Total lags used: 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb491"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests</span></span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(residuals_corrected, <span class="st">"pnorm"</span>, <span class="at">mean =</span> <span class="fu">mean</span>(residuals_corrected), <span class="at">sd =</span> <span class="fu">sd</span>(residuals_corrected))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  residuals_corrected
D = 0.060107, p-value = 0.2735
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(lm_corrected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  lm_corrected
BP = 17.395, df = 5, p-value = 0.003808</code></pre>
</div>
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reset</span>(lm_corrected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  lm_corrected
RESET = 5.2333, df1 = 2, df2 = 267, p-value = 0.005897</code></pre>
</div>
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lm_corrected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  taux_change       petrole precipitation  exportations    ar1_fitted 
     1.107362      1.130431      1.016294      1.005598      1.019534 </code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/isabel6198\.github\.io\/portfolio\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>